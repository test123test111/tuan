(function(){function e(e){return Lizard.WebresourcePDBaseUrl+e}require.config({paths:{TuanApp:e("tuanapp"),TuanStore:e("models/tuanstore"),TuanModel:e("models/tuanmodel"),DropDown:e("com/dropdown"),TuanFilters:e("widget/tuanfilters"),SmoothSlide:e("widget/slide"),TabSlide:e("widget/tabslide"),Switch:e("com/switch"),VoiceSearch:e("widget/voicesearch"),StoreManage:e("util/storemanage"),HttpErrorHelper:e("util/httperrortpl"),NumberStep:e("com/numberstep"),Payment:e("widget/payment"),ScrollObserver:e("util/scrollobserver"),MemCache:e("util/memcache"),InvoiceStore:e("thirdpart/invoicestore"),AMapWidget:e("widget/amap"),POIWidget:e("widget/poi"),LazyLoad:e("com/lazyload"),CallPhone:e("com/callPhone"),FilterXss:e("util/filterxss"),CityListData:e("data/citylist"),StringsData:e("data/strings"),Tab:e("com/tab"),PageHistory:e("com/history"),ConsoleDebug:e("debug/console"),PageTreeConfig:e("com/pagetreeconfig"),TuanBaseView:e("com/baseview"),ValidatorUtil:e("util/form/validator"),FieldUtil:e("util/form/field"),HomeTpl:e("templates/home.html"),ListProductTpl:e("templates/list.product.html"),ListBusinessTpl:e("templates/list.business.html"),BookingTpl:e("templates/booking.html"),BookingSuccessTpl:e("templates/booking.success.html"),CityListTpl:e("templates/citylist.html"),CouponTpl:e("templates/coupon.html"),DetailTpl:e("templates/detail.html"),DetailTipsTpl:e("templates/detail.tips.html"),HotelCommentsTpl:e("templates/hotel.comments.html"),HotelImagesTpl:e("templates/hotel.images.html"),HotelImageSlideTpl:e("templates/hotel.imageslide.html"),HotelMapTpl:e("templates/hotel.map.html"),HotelServiceTpl:e("templates/hotel.service.html"),HotelSubbranchTpl:e("templates/hotel.subbranch.html"),LashouTpl:e("templates/lashou.html"),InvoiceTpl:e("templates/invoice.html"),KeywordSearchTpl:e("templates/keywordsearch.html"),NearListTpl:e("templates/near.list.html"),RefundTpl:e("templates/refund.html"),RefundTipTpl:e("templates/refund.tip.html"),TuanOrderDetailTpl:e("templates/tuanorderdetail.html"),OrderDetailItemTpl:e("templates/order.detail.item.html"),RecommendTpl:e("templates/recommend.html"),MapNavTpl:e("templates/hotel.map.nav.html")}})})(),define("config",function(){}),define("PageTreeConfig",[],function(){var e={home:{prev:"",url:"/webapp/tuan/home",range:[]},list:{prev:"home",url:"/webapp/tuan/list",range:["home"]},lottery:{prev:"home",url:"/webapp/tuan/lottery",range:["home"]},localfeature:{prev:"home",url:"/webapp/tuan/localfeature",range:["home"]},listmap:{prev:"list",url:"/webapp/tuan/listmap",range:["list"]},detail:{prev:"list",url:"/webapp/tuan/detail/{did}.html?cityid={cityid}",range:["list","detail","home","nearlist","tuanorderdetail","listmap","bookingsuccess"],params:{did:0,cityid:0}},detailtips:{prev:"detail",url:"/webapp/tuan/detailtips",range:["detail"]},lashou:{prev:"list",url:"/webapp/tuan/lashou/{pid}.html",range:["detail"],params:{pid:0}},citylist:{prev:"home",url:"/webapp/tuan/citylist",range:[]},hotelimages:{prev:"detail",url:"/webapp/tuan/hotelimages/{did}.html",range:["detail"],params:{did:0}},hotelimageslide:{prev:"hotelimages",url:"/webapp/tuan/hotelimageslide?index={imgindex}",range:["hotelimages"],params:{imgindex:1}},hotelcomments:{prev:"detail",url:"/webapp/tuan/hotelcomments",range:["detail"]},hotelservice:{prev:"detail",url:"/webapp/tuan/hotelservice",range:["detail"]},detailtips:{prev:"detail",url:"/webapp/tuan/detailtips",range:["detail"]},hotelmap:{prev:"detail",url:"/webapp/tuan/hotelmap?lon={lon}&lat={lat}&hotelName={hotelname}",range:["detail","tuanorderdetail","hotelsubbranch"],params:{lon:0,lat:0,hotelname:""}},hotelmapnav:{prev:"hotelmap",url:"/webapp/tuan/hotelmapnav?url={url}",range:["hotelmap"],params:{url:""}},booking:{prev:"detail",url:"/webapp/tuan/booking",range:["detail"]},bookingsuccess:{prev:"list",url:"/webapp/tuan/bookingsuccess/{orderid}.html",range:["list"],params:{orderid:0}},coupon:{prev:"booking",url:"/webapp/tuan/coupon",range:["booking"]},invoice:{prev:"booking",url:"/webapp/tuan/invoice",range:["booking"]},hotelsubbranch:{prev:"detail",url:"/webapp/tuan/hotelsubbranch",range:["detail"]},keywordsearch:{prev:"home",url:"/webapp/tuan/keywordsearch",range:["home","list"]},nearlist:{prev:"detail",url:"/webapp/tuan/nearlist",range:["detail","bookingsuccess","tuanorderdetail"]},tuanorderdetail:{prev:"home",url:"/webapp/tuan/tuanorderdetail/{orderid}.html",range:["home","bookingsuccess"],params:{orderid:0}},refund:{prev:"home",url:"/webapp/tuan/refund/{orderid}.html",range:["home","tuanorderdetail"],params:{orderid:0}},refundtip:{prev:"tuanorderdetail",url:"/webapp/tuan/refundtip",range:["tuanorderdetail"]}};return e}),define("PageHistory",["c","cStore","PageTreeConfig"],function(e,t,n){function i(e){return e===null||e===undefined}function s(e){this.data={};for(var t in e)e[t]&&this.add(t,e[t].url,e[t].prev,e[t].jump,e[t].range,e[t].params)}function f(){this.stack=a.getInstance()}var r=e.base,o=/\{([^\{\}]+)\}/g;s.prototype={constructor:s,buildNode:function(e,t,n,r,i,s){return{id:e,prev:n,url:t,jump:r||!1,range:i,params:s||{}}},add:function(e,t,n,r,i,s){this.data[e]=this.buildNode(e,t,n,r,i,s)},getNode:function(e,t){var n=this.data[e];if(!n)return null;var r=n.url||"",s=n.param||{};t=t||{};var u=(n.url||"").replace(o,function(e,n){return i(t[n])?i(s[n])?"":s[n]:t[n]});return{id:n.id,prev:n.prev,url:n.url,reurl:u,jump:n.jump,range:n.range}},getPrevNode:function(e,t){var n=this.data[e],r=n&&n.prev&&this.data[n.prev]&&this.data[n.prev];if(!r)return null;t=t||{};var s=r.params||{},u=(r.url||"").replace(o,function(e,n){return i(t[n])?i(s[n])?"":s[n]:t[n]});return{id:r.id,url:r.url,prevurl:u,prev:r.prev,jump:r.jump,range:r.range}}};var u=new s(n),a=new r.Class(t,{__propertys__:function(){this.key="P_TUAN_HISTORY_STACK",this.lifeTime="30D",this.isUserData=!0},initialize:function($super,e){$super(e)},pop:function(){var e=this.getAttr("history")||[],t=e.pop();return this.setAttr("history",e),t},push:function(e,t){var n=this.getAttr("history")||[],r=Math.max(0,n.length-1);t?n[r]=e:n.push(e),this.setAttr("history",n)},top:function(){var e=this.getAttr("history")||[],t=Math.max(0,e.length-1);return e[t]},length:function(){var e=this.getAttr("history");return e&&e.length||0},clear:function(){this.setAttr("history",[])},index:function(e){var t=this.getAttr("history")||[];return e=e<0?t.length+e:e,t[e]},addCache:function(e,t,n){var r={id:e,obj:t,replace:n};this.setAttr("cache",r)},getCache:function(){return this.getAttr("cache")||{}},clearCache:function(){this.setAttr("cache",{})},popById:function(e){var t=this.getAttr("history")||[],n=-1,r=0,i=null;for(var s=t.length-1;s>-1;s--){r++;if(t[s].id===e){n=s;break}}return n>-1&&(i=t.splice(n,r)),this.setAttr("history",t),i},addSequeHistory:function(e){var t=this.getAttr("sequehistory")||[],n=Math.max(0,t.length-1),r=t[n]||{};if(r.id===e.id)return;t.length>10&&t.splice(0,3),t.push(e),this.setAttr("sequehistory",t)},getSequeTop:function(e){var t=this.getAttr("sequehistory")||[],n=Math.max(0,t.length-1),r=null;return t[n]&&(t[n].id!=e?r=t[n]:t[n-1]&&(r=t[n-1])),r}});f.prototype={constructor:f,push:function(e,t,n,r){this.stack.addCache(e,f.buildEntry(e,t,n),r)},confirmPush:function(e){var t=this.stack.getCache();t.id===e&&(this.stack.push(t.obj,t.replace),this.stack.clearCache())},pop:function(){return this.stack.pop()},top:function(){return this.stack.top()},index:function(e){return this.stack.index(e)},clear:function(){this.stack.clear()},getCache:function(){return this.stack.getCache()},clearCache:function(){this.stack.clearCache()},popById:function(e){return this.stack.popById(e)},addSequeHistory:function(e){this.stack.addSequeHistory(e)},getSequeTop:function(e){return this.stack.getSequeTop(e)}},f.buildEntry=function(e,t,n){return{id:e,url:t,ver:n}};var l="_____FROM_____",c=function(e,t){this.tree=e,this.stack=t};c.prototype={constructor:c,back:function(e,t){var n=this.stack.pop(),r=this.stack.top(),i=this.tree.getPrevNode(e,t),s=this.tree.getNode(e),o="",u=s.range||[];if(r&&r.id===l)return this.stack.addSequeHistory({id:e,url:o}),this.stack.pop(),{fullurl:r.url,url:r.url.replace(/^[^#]+#/g,"").replace(/^#+/g,""),jump:!0};var a=!1,e;return n&&n.id===e&&r&&r.id&&(!u.length||_.indexOf(u,r.id)>-1)?(o=r.url,a=n.ver!==r.ver||s.jump,e=r.id):(o=i.prevurl,a=!!s.jump,e=i.id,this.stack.clear()),this.stack.addSequeHistory({id:e,url:o}),{fullurl:o,url:o.replace(/^[^#]+#/g,"").replace(/^#+/g,""),jump:a,id:e}},popById:function(e){return this.stack.popById(e)},forward:function(e,t,n,r){if(typeof t=="object"){var i=this.tree.getNode(e,t);t=i.reurl}return this.stack.push(e,t,n,r),this.stack.addSequeHistory({id:e,url:t}),t},confirmForward:function(e){this.stack.confirmPush(e)},getLastView:function(){var e=this.stack.getCache()||{},t,n;return e.id?t=this.stack.top():t=this.stack.index(-2),t},getLatelyView:function(e){var t=this.stack.getSequeTop(e);return t?t.id:null},addHistory:function(e,t,n){var r=this.stack.getCache()||{};r.id&&r.id!==e&&this.stack.clearCache();var i=this.stack.top(),s=this._getFromByUrl(t);if(!i||i.id!==e||s)s&&(this.clearHistory(),this.stack.push(l,s),this.stack.addSequeHistory({id:l,url:s}),this.confirmForward(l)),this.stack.push(e,t,n),this.stack.addSequeHistory({id:e,url:t}),this.confirmForward(e)},clearHistory:function(e,t,n){this.stack.clear(),e&&t&&this.addHistory(e,t,n)},isPrevPageOrigin:function(){var e=this.getLastView();return e&&e.id===l},switchTree:function(e){this.tree=e},_getFromByUrl:function(e){var t="from",n=(e||"").split(/#+/g),r=n[0],i=n[1]||"",s=null;if(r.indexOf(t)>-1){var o=this._getQueryString(r);o[t]&&(s=o[t])}if(i.indexOf(t)>-1){var u=this._getQueryString(i);u[t]&&(s=u[t])}return s&&(s=decodeURIComponent(s)),s&&!s.match(/^\s*(?:http|\/)/)&&(s=null),s},_getQueryString:function(e){var t=(e||"").split("?");t.shift();var t=t.join("?").split(/(?!\?[^?]*)&/g),n={},r;for(var i=0,s=t.length;i<s;i++)r=t[i].split("="),n[r.shift()]=r.join("=");return n}};var h=new c(u,new f);return h}),define("TuanApp",["PageHistory"],function(e){var t=/^ctrip:\/\//i,n=/(.*)\/webapp\/(\w+)\/(.*)/,r=/^#\w/i;window._log=function(){};var i={init:function(){this.saveUnion()},isSEO:Lizard.renderAt==="server",showLoading:function(){this.loading.show()},hideLoading:function(){this.loading.hide()},isInternalPage:function(e){return e.toLowerCase().indexOf("/tuan/")>-1},back:function(e){var t=this.lastUrl();t?(this.app.history.pop(),this.isInternalPage(t)?location.hash=t.split("#")[1]||"home":location.replace(t)):(e?(e.indexOf("#")==-1&&(e="#"+e),this.app.curView.jump(e)):window.history.go(-1),this.app.history=[])},lastUrl:function(){var e=this.app.history,t=e.length,n=t&&e[t-2]||"";return n},parsePageURL:function(e){if(!e)return!1;var i={module:"",link:e,isNative:!1,isInternal:!1,domain:document.domain},s;return e.match(r)?(i.module="tuan",i.isInternal=!0,i):e.match(t)?(i.domain="ctrip",i.isNative=!0,i):(s=n.exec(e),s&&(i.module=s[2],i.link=s[3],i.isInternal=!0),i)},gotoExternalPage:function(e,t){require(["cUtility","cWidgetFactory","cWidgetGuider"],function(n,r){var i=r.create("Guider");n.isInApp()?i.cross({path:e,param:t}):location.href=location.protocol+"//"+location.host+"/webapp/"+e+"/"+t})},jumpToPage:function(e,t){if(!e)return;var n=this,r=n.parsePageURL(e);require(["cUtility","cWidgetFactory","cWidgetGuider"],function(n,i){var s=i.create("Guider"),o=n.isInApp();if(!o){location.href=e;return}if(r.isInternal){r.module=="tuan"?t.forwardJump(r.link.split("/")[0],"/webapp/tuan/"+r.link):s.cross({path:r.module,param:r.link});return}s.jump({targetModel:r.isNative?"app":"h5",url:r.link,title:document.title})})},getQuery:function(e){return Lizard.P(e)},saveUnion:function(e){require(["CommonStore"],function(t){var n=t.UnionStore&&t.UnionStore.getInstance(),r=i.getQuery("PartnerID"),s=i.getQuery("Source"),o=i.getQuery("AllianceID"),u=i.getQuery("SID"),a=i.getQuery("OUID"),f=n.get();!s&&!o?e==1&&document.referrer!=""&&document.referrer.indexOf("/html5")>0&&f&&f.targetTuan==1&&n.remove():(!f||f.AllianceID!=o||f.SID!=u||f.OUID!=a||f.Source!=s||f.PartnerID!=r)&&n.set({AllianceID:o,SID:u,OUID:a,Source:s,PartnerID:r,targetTuan:!0})})},initVoiceSearch:function(e){require(["cWidgetFactory","VoiceSearch"],function(t){var n=t.create("VoiceSearch");new n(e)})},environment:0,tHome:function(){require(["cUtility","cWidgetFactory","cWidgetGuider"],function(e,t){var n=t.create("Guider"),r=e.isInApp();r?n.home():location.href=location.protocol+"//"+location.host+"/html5"})},backToLastPage:function(){require(["cWidgetFactory","cWidgetGuider"],function(e){var t=e.create("Guider");t.backToLastPage({param:JSON.stringify({biz:"tuan",refresh:"1"})})})},isOverOS7:function(){return $.os&&$.os.ios&&parseInt($.os.version,10)>=7}};return require(["libs","cUtility","cWidgetFactory","cHybridFacade","cWidgetGuider"],function(e,t,n,r){var s=n.create("Guider");i.init(),t.isInApp()&&(_.isFunction(s.app_check_network_status)&&s.app_check_network_status({callback:function(e){i.environment=e.networkType==="WIFI"?0:1}}),s.register({tagname:r.METHOD_APP_NETWORK_DID_CHANGED,callback:function(e){i.environment=e.networkType==="WIFI"?0:1}})),function(){var n,r,i,s;if(t.isInApp()){r=t.isPreProduction();if(r==="0"||r==="1"||r==="2")i=!0}else location.host.match(/^(m|3g|wap)\.ctrip\.com/i)||(i=!0);if(i){n=$('<i style="position:fixed;bottom:300px;color:green;z-index:9999;">CL</i>').appendTo("#main"),n.on("click",function(){!s&&require(["ConsoleDebug"],function(e){s=new e}),s&&s.show()});var o=setInterval(function(){var e=$(".dl_panel-bg .dl_btn-close");e&&e.length&&(e.trigger("click"),clearInterval(o))},100)}}()}),window.noPic=function(e){e&&(e.src="http://pic.c-ctrip.com/common/pic_alpha.gif",e.onerror=null)},i}),define("TuanStore",["cStore","cBase","cUtility"],function(e,t,n){var r={},i=6;return r.TuanDetailsStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_DETAILS",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.TuanStatusStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_STATUS",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.TuanBranchOfficeStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_BRANCH_OFFICE",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.TuanHotelCommentListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_HOTEL_COMMENT",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.TuanInvoiceStore=new t.Class(e,{__propertys__:function(){this.key="GROUP_INVOICE",this.lifetime="30M"},initialize:function($super,e){$super(e)}}),r.TuanOrderListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_ORDER_LIST",this.lifeTime="3M"},initialize:function($super,e){$super(e)}}),r.TuanOrderInfoStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_ORDER_INFO",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.GroupListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_LIST",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.GroupHotelListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_HOTEL_LIST",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.GroupHotListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_HOT_LIST",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.GroupSearchStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_SEARCH",this.lifeTime="1D",this.defaultData={pageIdx:"1",ctyId:"2",ctyName:"上海",bdate:t.Date.format(n.getServerDate(),"Y-m-d H:i:s"),edate:t.Date.format(n.getServerDate(),"Y-m-d H:i:s"),flag:0,productType:"0",qparams:[],sortRule:"2",sortType:"0",ver:i,ctype:0}},initialize:function($super,e){$super(e)}}),r.GroupPositionFilterStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_POSITIONFILTER",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.GroupConditionStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_CONDITIONFILTER",this.lifeTime="3D"},initialize:function($super,e){$super(e)}}),r.TuanOrderDetailStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_ORDER_DETAIL",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.GroupOrderParamStore=new t.Class(e,{__propertys__:function(){this.key="USER_GROUP_ORDERPARAM",this.lifeTime="15M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),r.OrderDetailReturnPage=new t.Class(e,{__propertys__:function(){this.key="GROUP_RETURNPAGE",this.lifeTime="15M"},initialize:function($super,e){$super(e)}}),r.TuanCityListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_CITY_LIST",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.TuanHistoryCityListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_HISTORYCITY_LIST",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.GroupCategoryFilterStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_CATEGORYFILTER",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.GroupSortStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_SORTFILTER",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.TuanHistoryKeySearchStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_HISTORYKEYSEARCH_LIST",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.TuanKeyWordListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_KEYWORD_LIST",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.TuanLocalCityInfoStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_LOCAL_CITY_INFO",this.lifeTime="30M"},initialize:function($super,e){$super(e)}}),r.GroupGeolocation=new t.Class(e,{__propertys__:function(){this.key="TUAN_GEOLOCATION",this.lifeTime="60M"},initialize:function($super,e){$super(e)}}),r.GroupCustomFilters=new t.Class(e,{__propertys__:function(){this.key="TUAN_CUSTOM_FILTERS",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.TuanInvoiceTitleStore=new t.Class(e,{__propertys__:function(){this.key="TuanGou_InvoiceTitle",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r.TuanImagesListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_IMAGES_LIST",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.TuanPOIListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_POI_LIST",this.lifeTime="15D"},initialize:function($super,e){$super(e)}}),r.TuanNearListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_NEAR_LIST",this.lifeTime="15D"}}),r.TuanStrategyIDStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_STRATEGY_ID",this.lifeTime="15D"}}),r.TuanCouponListStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_COUPON_LIST",this.lifeTime="1D"}}),r.TuanSelectedCouponStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_SELECTED_COUPON",this.lifeTime="1D"}}),r.ColaPrizeStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_COLA_PRIZE",this.lifeTime="1D"}}),r.TuanHotKeywords=new t.Class(e,{__propertys__:function(){this.key="TUAN_HOT_KEYWORDS",this.lifeTime="1D"}}),r.TuanRegionInfoStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_REGION_INFO",this.lifeTime="1D"}}),r.TuanPositionStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_POSITION",this.lifeTime="2M"},initialize:function($super,e){$super(e)}}),r.BannerClassStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_BANNER_CLASS",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),window.testStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_TEST",this.lifeTime="1M"}}),r.TicketBookingStore=new t.Class(e,{__propertys__:function(){this.key="TUAN_TICKET_BOOKING",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),r}),define("TuanModel",["cModel","cBase","TuanStore","cUtility"],function(e,t,n,r){e.baseurl=function(e){var t={test:"soa2/10101",uat:"restapi/soa2/10101",pro:"restapi/soa2/10101"},n={test:"m.fat.ctripqa.com",uat:"m.uat.ctripqa.com",pro:"m.ctrip.com"},i=location.host,s=n.test,o=t.test;return r.isInApp()?r.isPreProduction()=="1"?(e=="https"?s="restful.m.ctrip.com":s=n.pro,o=t.pro):r.isPreProduction()=="0"?(e=="https"?s="restful.waptest.ctrip.com":s=n.test,o=t.test):r.isPreProduction()=="2"?(s=n.uat,o=t.uat):(e=="https"?s="restful.m.ctrip.com":s=n.pro,o=t.pro):i.match(/^(m|3g|wap)\.ctrip\.com/i)?(s=n.pro,o=t.pro):!i.match(/^(localhost|172\.16|127\.0)/i)||location.protocol!="https"&&e!="https"?i.match(/^(localhost|172\.16|127\.0)/i)?e=="https"?(s="restful.waptest.ctrip.com",o=t.test):(s=n.test,o=t.test):i.match(/^10\.8\.2\.111/i)?(s=n.pro,o=t.pro):!i.match(/^waptest\.ctrip|^210\.13\.100\.191/i)||location.protocol!="https"&&e!="https"?i.match(/^waptest\.ctrip|^210\.13\.100\.191/i)?(s="waptest.ctrip.com",o=t.test):i.match(/^m\.uat/i)?(s=n.uat,o=t.uat):(s=n.test,o=t.test):(s="restful.waptest.ctrip.com",o=t.test):(s="restful.waptest.ctrip.com",o=t.test),{domain:s,path:o}};var i={},s=6;return i.TuanDetailModel=new t.Class(e,{__propertys__:function(){this.url="/json/DetailSearch",this.method="POST",this.param={ext:"",flag:0,id:33483,ver:s},this.result=n.TuanDetailsStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanStatusModel=new t.Class(e,{__propertys__:function(){this.url="/json/RoomStatusSearch",this.method="POST",this.param={bdate:"",edate:"",pid:0,ext:"",flag:0,ver:s},this.result=n.TuanStatusStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanBranchOfficeModel=new t.Class(e,{__propertys__:function(){this.url="/json/BranchOffice",this.method="POST",this.param={ext:"",flag:0,id:0,ver:s},this.result=n.TuanBranchOfficeStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanHotelCommentListModel=new t.Class(e,{__propertys__:function(){this.url="/json/CommentListSearch",this.method="POST",this.param={ext:"",flag:0,hotelId:0,pageIdx:1,ver:s},this.result=n.TuanHotelCommentListStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanOrderListModel=new t.Class(e,{__propertys__:function(){this.url="/OrderList/Query",this.method="POST",this.isUserData=!0,this.param={ext:"",flag:0,pageIdx:1,ver:s},this.result=n.TuanOrderListStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanOrderDetailModel=new t.Class(e,{__propertys__:function(){this.url="/json/OrderDetailSearch",this.method="POST",this.usehead=!0,this.param={ext:"",flag:0,ver:s},this.result=n.TuanOrderDetailStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanSendMsgModel=new t.Class(e,{__propertys__:function(){this.url="/json/MessageSend",this.method="POST",this.usehead=!0,this.param={ext:"",flag:0,ver:s}},initialize:function($super,e){$super(e)}}),i.TuanListModel=new t.Class(e,{__propertys__:function(){this.url="/json/ListSearch",this.method="POST",this.result=n.GroupListStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanHotelListModel=new t.Class(e,{__propertys__:function(){this.url="/json/HotelListSearch",this.method="POST",this.result=n.GroupHotelListStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanHotListModel=new t.Class(e,{__propertys__:function(){this.url="/json/HotCitySearch",this.method="POST",this.usehead=!0,this.param={ext:"",flag:0,ver:s},this.result=n.GroupHotListStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanConditionModel=new t.Class(e,{__propertys__:function(){this.url="/json/ConditionListSearch",this.method="POST",this.param={ver:s},this.result=n.GroupConditionStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanCityListModel=new t.Class(e,{__propertys__:function(){this.url="/json/CityListSearch",this.method="POST",this.param={dataVer:99,ver:s},this.result=n.TuanCityListStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanKeyWordListModel=new t.Class(e,{__propertys__:function(){this.url="/json/KeywordSearch",this.method="POST",this.param={},this.result=n.TuanKeyWordListStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanLocalCityInfo=new t.Class(e,{__propertys__:function(){this.url="/json/SearchCityIdByLat",this.param={},this.method="POST",this.result=n.TuanLocalCityInfoStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanCreateOrder=new t.Class(e,{__propertys__:function(){this.url="/json/CreateOrder",this.param={ver:s},this.method="POST"},initialize:function($super,e){$super(e)}}),i.TuanSubmitOrder=new t.Class(e,{__propertys__:function(){this.url="/json/SubmitOrder",this.param={},this.method="POST"},initialize:function($super,e){$super(e)}}),i.TuanApplyOrder=new t.Class(e,{__propertys__:function(){this.url="/json/PaymentApply",this.param={},this.method="POST"},initialize:function($super,e){$super(e)}}),i.TuanRetryPayment=new t.Class(e,{__propertys__:function(){this.usehead=!0,this.url="/json/ContinueToPay",this.param={ver:s},this.method="POST"},initialize:function($super,e){$super(e)}}),i.BannerSearch=new t.Class(e,{__propertys__:function(){this.usehead=!0,this.url="/json/bannersearch",this.param={ver:s},this.method="POST"},initialize:function($super,e){$super(e)}}),i.TuanRefundlTicketModel=new t.Class(e,{__propertys__:function(){this.usehead=!0,this.url="/json/cancelticket",this.param={ver:s},this.method="POST"},initialize:function($super,e){$super(e)}}),i.TuanCancelOrderModel=new t.Class(e,{__propertys__:function(){this.usehead=!0,this.url="/json/OrderCancel",this.param={},this.method="POST"},initialize:function($super,e){$super(e)}}),i.TuanDeleteOrderModel=new t.Class(e,{__propertys__:function(){this.usehead=!0,this.url="/json/OrderDelete",this.param={},this.method="POST"},initialize:function($super,e){$super(e)}}),i.TuanImagesListModel=new t.Class(e,{__propertys__:function(){this.url="/json/ProductPictures",this.param={},this.method="POST",this.result=n.TuanImagesListStore.getInstance()}}),i.TuanPOIListModel=new t.Class(e,{__propertys__:function(){this.url="/json/POISearch",this.param={ver:s},this.method="POST",this.result=n.TuanPOIListStore.getInstance()}}),i.TuanNearListModel=new t.Class(e,{__propertys__:function(){this.url="/json/NearGroup",this.param={},this.method="POST",this.result=n.TuanNearListStore.getInstance()}}),i.TuanStrategyIDModel=new t.Class(e,{__propertys__:function(){this.url="/json/Destination",this.param={},this.method="POST",this.result=n.TuanStrategyIDStore.getInstance()}}),i.TuanValidateCouponModel=new t.Class(e,{__propertys__:function(){this.url="/json/ValidateCoupon",this.param={},this.method="POST"}}),i.TuanCouponListModel=new t.Class(e,{__propertys__:function(){this.url="/json/CouponList",this.param={ver:s},this.method="POST",this.result=n.TuanCouponListStore.getInstance()}}),i.ColaDrawModel=new t.Class(e,{__propertys__:function(){this.url="/json/GetPrizeResultService",this.param={},this.method="POST"}}),i.ColaAddPrizeModel=new t.Class(e,{__propertys__:function(){this.url="/json/SetPrizeToUser",this.param={},this.method="POST"}}),i.TuanAddFavorite=new t.Class(e,{__propertys__:function(){this.url="/json/FavoriteAdd",this.param={},this.method="POST"}}),i.TuanDelFavorite=new t.Class(e,{__propertys__:function(){this.url="/json/FavoriteDelete",this.param={},this.method="POST"}}),i.TuanHotKeywordsModel=new t.Class(e,{__propertys__:function(){this.url="/json/SearchHotWord",this.method="POST",this.param={cityid:0},this.result=n.TuanHotKeywords.getInstance()},initialize:function($super,e){$super(e)}}),i.TuanRegionInfoModel=new t.Class(e,{__propertys__:function(){this.url="/json/ExpressCity",this.method="POST",this.param={},this.result=n.TuanRegionInfoStore.getInstance()},initialize:function($super,e){$super(e)}}),i.CrossRecommendModel=new t.Class(e,{__propertys__:function(){this.url="/json/ProductRecommend",this.method="POST",this.param={ver:s}},initialize:function($super,e){$super(e)}}),i.BannerClassModel=new t.Class(e,{__propertys__:function(){this.url="/json/BannerClass",this.method="POST",this.param={},this.result=n.BannerClassStore.getInstance()},initialize:function($super,e){$super(e)}}),i.TicketBookingModel=new t.Class(e,{__propertys__:function(){this.url="/json/TicketBooking",this.method="POST",this.param={},this.result=n.TicketBookingStore.getInstance()},initialize:function($super,e){$super(e)}}),i}),define("DropDown",["libs","cUIMask"],function(e,t){function i(e){var i={triggerEvent:"click",trigger:null,panel:null,label:null,itemCls:"li[data-type]",hasEffect:!0,hasMask:!0,selectedIndex:0,activeTriggerCls:"",selectedItemCls:"typecrt",multiple:!1,onShow:n,onHide:n,onSelect:n},s=this;this.options=r(i,e),this.trigger=this.options.trigger,this.panel=this.options.panel,this.label=this.options.label,this.disabled=!1,this.opened=!1,this.items=this.panel.find(this.options.itemCls),this.reset(!0),this.options.hasMask&&(this.mask=new t({onCreate:function(){var e=this;this.root.on("click",function(){s.hide(),e.hide()})}}),this.panel.css("z-index",9999)),this._bindEvents()}var n=function(){},r=$.extend;return i.prototype={constructor:i,_bindEvents:function(){var e=this,t=this.options,n=this.trigger;this._showHandler=$.proxy(function(n){this.opened?(this.hide(),t.onHide.call(e)):(this.show(),t.onShow.call(e))},this),this._selectHandler=$.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.select(e.target),this.hide()},this),this._hideHandler=$.proxy(function(e){var t=this;setTimeout(function(){t.hide()},200)},this),n.on(t.triggerEvent,this._showHandler),n.on("blur",this._hideHandler),this.panel.on("click",t.itemCls,this._selectHandler)},_unbindEvents:function(){var e=this.options;this.trigger.off(e.triggerEvent,this._showHandler),this.panel.off("click",this._selectHandler)},disable:function(){this._unbindEvents(),this.disabled=!0},enable:function(){this._bindEvents(),this.disabled=!1},show:function(){var e=this.panel;e.show(),this.options.hasEffect&&(e.css({"-webkit-transform":"translate(0, 30px) translateZ(0)",opacity:0}),e.animate({"-webkit-transform":"translate(0, -8px) translateZ(0)",opacity:1})),this.mask&&this.mask.show(),this.trigger.addClass(this.options.activeTriggerCls),this.opened=!0},hide:function(){var e=this;e.panel.hide(),e.mask&&e.mask.hide(),e.trigger.removeClass(e.options.activeTriggerCls),e.opened=!1},getItemByAttr:function(e,t){return this.panel.find("[data-"+e+'="'+t+'"]')},getItemByIndex:function(e){return this.items[e]},select:function(e,t){var n=this.options,r=this._selected,i=n.selectedItemCls;r&&r.removeClass(i),e.tagName!="LI"&&(e=e.parentNode),this.selectedIndex=this.items.indexOf(e),e=$(e),this.label.html(e.attr("data-name")||e.text()),e.addClass(i),!t&&this.options.onSelect.call(this,e),this._selected=e},reset:function(e,t){this.select(this.items[typeof t=="number"?t:this.options.selectedIndex],e)}},i}),define("Tab",["libs","cUIScroll"],function(e,t){function i(e){var t={onSwitch:r};this.options=n(t,e),this.panel=this.options.panel,this.label=this.options.label,this.isScroll=this.options.isScroll,this.inited=!1,this.switch(this.options.labelSelectedIndex),this._bindEvents()}var n=$.extend,r=function(){};return i.prototype={constructor:i,_bindEvents:function(){var e=this.options;this._switchHandler=$.proxy(function(e){var t=this.label.indexOf(e.currentTarget);this.switch(t)},this),this._selectHandler=$.proxy(function(t){e.onSelect($(t.currentTarget))},this),this.label.on("click",this._switchHandler),this.panel.on("click",e.itemClass,this._selectHandler)},_unbindEvents:function(){var e=this.options;this.trigger.off(e.triggerEvent,this._showHandler),this.panel.off("click",this._selectHandler)},"switch":function(e){var n=this.options;this.options.onSwitch(),$(this.label[n.labelSelectedIndex]).removeClass(n.labelSelectedClass),$(this.label[e]).addClass(n.labelSelectedClass),$(this.panel[n.labelSelectedIndex]).hide();var r=$(this.panel[e]);r.show(),n.isScroll&&(r.css({overflow:"hidden","max-height":"285px","margin-bottom":"5px","margin-top":"5px"}),new t({wrapper:r,scroller:r.find("ul")})),this.options.labelSelectedIndex=e;if(this.inited){var i=r.find(n.itemClass);i.length==1&&n.onSelect(i)}this.inited=!0}},i}),define("StringsData",[],function(){var e=4;return{SEARCH_DISTANCE:e,SEARCH_DISTANCE_TEXT:e+"公里内",MAP_SOURCE_ID:3,MAX_KEYWORDS_HISTORY:5,CITY_CENTER:"市中心",defaultCity:{id:2,name:"上海"},priceText:{"0|99":"&yen; 100 以下","100|250":"&yen; 100-250","250|400":"&yen; 250-400","400|600":"&yen; 400-600","601|":"&yen; 600 以上","0|1999":"&yen; 2000 以下","2000|3000":"&yen; 2000-3000","3001|":"&yen; 3000 以上"},traitText:{"103|101":"一元酒店","103|10303":"别墅轰趴","103|10304":"住店游玩","103|10305":"情侣酒店"},starText:{2:"二星/经济",3:"三星/舒适",4:"四星/高档",5:"五星/豪华"},groupType:{0:{index:0,name:"全部团购",category:"all"},1:{index:1,name:"酒店",category:"hotel"},8:{index:2,name:"美食",category:"catering"},7:{index:3,name:"旅游度假",category:"vacation"},6:{index:4,name:"门票",category:"ticket"},9:{index:5,name:"娱乐",category:"entertainment"},106:{index:6,name:"一元团购",category:"onepaygroup"},108:{index:7,name:"当地特色",category:"feature"}},index2ctype:{0:"0",1:"1",2:"8",3:"7",4:"6",5:"9"}}}),define("CityListData",[],function(){return{1:"北京",2:"上海",3:"天津",4:"重庆",5:"哈尔滨",6:"大连",7:"青岛",10:"西安",11:"敦煌",12:"南京",13:"无锡",14:"苏州",15:"扬州",16:"镇江",17:"杭州",18:"西塘",19:"舟山",20:"淳安",21:"千岛湖镇",22:"绍兴",23:"黄山",24:"九江",25:"厦门",26:"武夷山",27:"张家界",28:"成都",30:"深圳",31:"珠海",32:"广州",33:"桂林",34:"昆明",35:"西双版纳",36:"大理市",37:"丽江",38:"贵阳",39:"乌鲁木齐",40:"吐鲁番市",41:"拉萨",42:"海口",43:"三亚",44:"文昌",45:"万宁",46:"五指山",47:"屯昌",48:"东方",50:"定安",52:"琼海",54:"保亭",55:"陵水",57:"儋州",58:"香港",59:"澳门",82:"南通",83:"昆山",84:"海宁",86:"湖州",87:"奉化",90:"临安",91:"九寨沟",92:"日喀则",94:"都江堰",95:"峨眉山",96:"常熟",99:"银川",100:"兰州",103:"呼和浩特",104:"平遥",105:"太原",106:"五台山",108:"林芝",109:"喀什市",110:"延安",111:"咸阳",112:"宝鸡",117:"潼关",118:"铜川",119:"华阴",124:"西宁",129:"汉中",132:"格尔木",133:"榆次",134:"灵石",135:"介休",136:"大同",137:"长治",139:"临汾",140:"运城",141:"包头",143:"曲阜",144:"济南",145:"泰山",147:"秦皇岛",149:"齐齐哈尔",150:"牡丹江",155:"漠河",158:"长春",159:"吉林",171:"安康",177:"安庆",178:"鞍山",179:"安顺",180:"安溪",181:"安阳",182:"蚌埠",185:"保定",186:"玉溪",187:"北戴河",189:"北海",197:"保山",199:"长白山",201:"常德",202:"赤峰",203:"长乐",206:"长沙",209:"广德",210:"顺德",211:"朝阳",213:"常州",214:"滁州",215:"潮州",216:"沧州",218:"池州",221:"丹东",222:"登封",223:"东莞",231:"大庆",236:"东营",237:"德阳",238:"丹阳",245:"恩施",246:"福鼎",247:"丰都",251:"佛山",252:"抚顺",254:"阜新",256:"富阳",257:"阜阳",258:"福州",267:"广元",268:"赣州",270:"惠安",272:"淮北",275:"邯郸",278:"合肥",281:"黑河",282:"怀化",283:"汉口",285:"哈密市",287:"淮南",288:"华山",290:"衡水",292:"黄石",296:"黄岩",297:"衡阳",299:"惠州",305:"景德镇",307:"井冈山",308:"金华",309:"景洪",310:"蓬莱",314:"九龙",316:"江门",317:"佳木斯",318:"济宁",321:"固原",324:"建阳",325:"江阴",326:"嘉峪关",327:"锦州",328:"荆州",330:"库尔勒",331:"开封",333:"凯里",335:"开平",340:"廊坊",344:"庐山",345:"乐山",346:"丽水",348:"龙岩",350:"洛阳",351:"辽阳",352:"辽源",353:"连云港",354:"柳州",355:"泸州",365:"德宏",370:"绵阳",374:"南安",375:"宁波",376:"南昌",377:"南充",378:"宁德",380:"南宁",385:"南阳",387:"盘锦",388:"平凉",392:"平潭",403:"黟县",406:"泉州",407:"衢州",408:"瑞安",411:"上饶",412:"瑞丽",421:"绥芬河",422:"韶关",426:"石河子",427:"梁平",428:"石家庄",431:"石林",433:"汉寿",436:"三门峡",437:"三明",440:"四平",441:"商丘",443:"泗水",444:"石狮",446:"韶山",447:"汕头",448:"邵武",451:"沈阳",452:"十堰",454:"泰安",456:"通化",458:"通辽",459:"铜陵",460:"桐庐",464:"天水",468:"唐山",470:"天台",474:"武当山",475:"潍坊",477:"武汉",478:"芜湖",479:"威海",481:"吴江",484:"乌兰浩特",485:"永安",489:"婺源",491:"温州",492:"梧州",493:"新安江",494:"西昌",496:"襄阳",500:"锡林浩特",503:"萧山",507:"新乡",508:"歙县",510:"信阳",512:"徐州",513:"忻州",514:"宜宾",515:"宜昌",518:"宜春",521:"宿州",523:"延吉",527:"榆林",529:"伊宁市",533:"烟台",534:"鹰潭",536:"义乌",537:"宜兴",539:"岳阳",540:"余姚",541:"兖州",542:"淄博",544:"自贡",545:"遵化",547:"湛江",548:"诸暨",550:"张家口",551:"驻马店",552:"肇庆",553:"中山",555:"昭通",556:"中卫",557:"浑源",558:"遵义",559:"郑州",560:"漳州",561:"周庄",562:"承德",569:"临沂",571:"嘉兴",577:"淮安",578:"台州",579:"泰州",580:"桐乡",582:"海盐",583:"九华山",589:"巢湖",595:"上虞",596:"嘉善",598:"湘潭",601:"株洲",603:"新余",605:"六盘水",606:"南平",612:"郴州",614:"枣庄",617:"台北",619:"温岭",620:"雁荡山",621:"张家港",654:"太仓",658:"建德",659:"安吉",660:"香格里拉",662:"酒泉",663:"张掖",664:"武威",667:"莆田",677:"衡山",692:"阳江",693:"河源",696:"盱眙",697:"启东",729:"台山",732:"乐清",750:"广汉",755:"东阳",833:"荣成",866:"凤凰",868:"仙居",870:"三清山",871:"阳朔",872:"新昌",887:"吴桥",893:"庐江",894:"东海",895:"新沂",900:"砀山",905:"辛集",907:"阳泉",909:"滕州",918:"娄底",929:"浦江",933:"吉安",937:"咸宁",940:"耒阳",944:"桐城",947:"邢台",951:"鹤壁",956:"揭阳",957:"偃师",958:"巩义",959:"武义",960:"永康",963:"海城",965:"塘沽",966:"瓦房店",967:"大石桥",969:"荥阳",970:"永州",975:"都匀",983:"桐梓",984:"宣威",985:"曲靖",986:"镇远",992:"鄂州",996:"古田",1e3:"江山",1001:"玉山",1005:"宁国",1006:"宣城",1007:"当涂",1008:"绩溪",1010:"凤阳",1011:"宁乡",1016:"繁昌",1022:"兴平",1023:"灵宝",1024:"马鞍山",1026:"祁门",1029:"义马",1030:"渭南",1031:"临潼",1037:"海阳",1038:"莱阳",1040:"高密",1043:"胶州",1044:"青州",1048:"铁岭",1050:"葫芦岛",1051:"兴城",1052:"昌黎",1054:"江油",1055:"勉县",1058:"邓州",1060:"汝州",1068:"霸州",1071:"聊城",1073:"梁山",1074:"菏泽",1078:"亳州",1079:"麻城",1083:"满洲里",1088:"漯河",1090:"定州",1092:"晋城",1093:"焦作",1094:"许昌",1095:"侯马",1097:"攀枝花",1098:"怀柔",1105:"茂名",1106:"日照",1107:"长兴",1110:"吉首",1113:"玉林",1116:"白城",1117:"随州",1121:"荆门",1122:"当阳",1123:"石门",1125:"益阳",1128:"绥化",1133:"乌海",1139:"兴义",1140:"百色",1148:"眉山",1155:"本溪",1200:"盐城",1201:"宁海",1205:"同里",1206:"平湖",1208:"慈溪",1209:"临海",1212:"嵊州",1221:"涉县",1222:"稻城",1223:"江都",1224:"仪征",1226:"南戴河",1230:"崇明",1232:"濮阳",1233:"达州",1300:"营口",1303:"松原",1317:"朔州",1323:"澧县",1332:"千岛湖",1333:"开远",1341:"红河",1342:"文山县",1358:"溧阳",1367:"德清",1370:"德州",1371:"遂宁",1372:"松潘",1422:"清远",1428:"恩平",1436:"汕尾",1443:"泰顺",1452:"莱芜",1453:"晋中",1454:"济源",1466:"安图",1472:"宿迁",1474:"丰宁",1490:"孝感",1495:"河口",1517:"汉源",1518:"贵港",1521:"赤壁",1541:"白银",1555:"枣阳",1557:"枝江",1565:"开原",1575:"安平",1592:"江津",1610:"榆树",1632:"三河",1634:"顺义",1635:"蓟县",1646:"庄河",1658:"阿尔山",1664:"亚布力",1677:"防城港",1700:"瑞昌",1705:"六安",1706:"海螺沟",1708:"荔波",1803:"晋江",1804:"莱西",1806:"怒江",1819:"腾冲",1820:"滨州",1823:"象山",1838:"阿坝",1839:"金坛",1840:"萍乡",1882:"仙桃",1884:"肥城",1892:"来宾",1893:"南丹",1899:"钦州",1904:"师宗",1983:"徐水",1991:"新乐",1993:"正定",1996:"元氏",2049:"修武",2063:"沁阳",2088:"北碚",2096:"大厂",2109:"伊川",2230:"迁安",2313:"水富",2431:"蒙自",2442:"建水",2552:"大英",2607:"五峰",2625:"绵竹",2950:"林口",2963:"平山",2966:"尚志",3053:"梅州",3221:"周口",3222:"平顶山",3230:"句容",3233:"东台",3275:"阆中",3277:"雅安",3309:"横店",3327:"布尔津",3329:"通州",3852:"黎平",3863:"寿光",3881:"泗阳",3884:"抚州",3885:"黄冈",3886:"白山",3887:"巴彦淖尔",3906:"即墨",3908:"文登",3909:"胶南",3913:"沂源",3914:"大冶",3915:"莱州",3917:"福清",3918:"乌镇",3921:"楚雄市",3923:"海安",3925:"玉环",3926:"靖江",3929:"邳州",3931:"连州",3933:"云浮",3937:"扬中",3943:"平度",3944:"彬县",3946:"龙口",3967:"东兴",3968:"桂平",3969:"河池",3972:"宜都",3976:"鄂尔多斯",3980:"泰兴",3989:"济阳",3995:"舞钢",3996:"普洱",3997:"芒市",4004:"靖边",4026:"姜堰",4029:"大丰",4124:"甘孜",4125:"高邮",4130:"康定",4132:"香河",4136:"新密",4139:"如皋",4144:"诸城",4145:"陆丰",4146:"贺州",4154:"潜江",4159:"博鳌",4185:"浏阳",4216:"石嘴山",4243:"弥勒",4244:"普陀山",4251:"招远",4255:"呼伦贝尔",7519:"邹城",7521:"龙胜",7525:"北川",7534:"昌吉市",7536:"平邑",7544:"赤水",7549:"泸定",7551:"商洛",7553:"邛崃",7554:"乳山",7557:"如东",7558:"三门",7559:"海门",7561:"密云",7564:"平谷",7567:"房山",7577:"天长",7578:"兴化",7587:"吴忠",7592:"南康",7593:"章丘",7594:"元阳",7596:"扶风",7604:"汾阳",7605:"涿州",7606:"吴川",7618:"洪湖",7619:"仁怀",7630:"沂水",7631:"吕梁",7637:"栾川",7638:"额尔古纳",7646:"酉阳",7650:"长葛",7663:"大兴安岭",7666:"苍南",7667:"罗田",7669:"栖霞",7673:"郓城",7674:"长岛",7675:"沂南",7678:"崇州",7680:"垦利",7685:"丹江口",7687:"藁城",7692:"金湖",7693:"涟水",7694:"睢宁",7695:"响水",7700:"五莲",7714:"莒南",7716:"大邑",7724:"武功山",7727:"贺兰",7728:"东平",7745:"金乡",7751:"理县",7759:"河间",7771:"新泰",7779:"利川",7799:"白沟",7834:"若尔盖",7835:"红原",7840:"沽源",10270:"杨凌",10271:"洛宁",10272:"丹巴",10273:"莒县",10297:"昌乐",10298:"茂县",19953:"平原",19956:"高唐",19959:"蒙阴",20743:"微山",20794:"灵武",20807:"和顺镇",20808:"吉县",20809:"临沭",20812:"嵩县",20825:"灌南",20827:"肥东",20846:"惠水",20849:"永泰",20868:"临高",20881:"长武",20883:"阿巴嘎旗",20896:"鹿泉",20898:"衡阳县",20914:"围场",20916:"滨海",20919:"澄江",20926:"社旗",20932:"青阳",20950:"盂县",20960:"元谋",20963:"文山",20976:"多伦",20980:"霞浦",20990:"晋州",21001:"克什克腾旗",21008:"休宁",21009:"新郑",21025:"白沙",21027:"芜湖县",21052:"长阳",21056:"芦溪",21089:"涞水",21094:"固始",21096:"雅江",21111:"沭阳",21115:"金寨",21138:"巨野",21140:"潜山",21144:"肥乡",21166:"洪泽",21168:"汶上",21179:"黔南",21182:"盐源",21183:"石柱",21194:"中牟",21199:"黔西",21208:"勐腊",21214:"栾城",21230:"阜宁",21258:"唐县",21259:"武隆",21268:"大理",21269:"阿拉善左旗",21286:"雷山",21301:"南部",21316:"彭水",21330:"迁西",21339:"额济纳旗",21349:"房县",21385:"费县",21399:"鄄城",21404:"赣榆",21409:"石台",21410:"涡阳",21411:"周至",21416:"南靖",21421:"长沙县",21436:"织金",21437:"灌云",21448:"馆陶",21452:"永春",21464:"抚松",21469:"博爱",21475:"华容",21486:"定边",21488:"肥西",21490:"文安",21508:"永顺",21509:"连江",21511:"祁县",21514:"璧山",21515:"商河",21542:"于都",21555:"青川",21560:"仙游",21563:"曲沃",21574:"泰宁",21584:"巴林左旗",21590:"建湖",21603:"射阳",21609:"小金",21610:"开县",21619:"遂平",21624:"献县",21629:"金沙",21633:"湘阴",21648:"无为",21660:"昌邑",21675:"桂阳",21683:"威宁",21691:"北流",21699:"孟州",21710:"眉县",21739:"星子",21750:"赵县",21764:"荣昌",21765:"太仆寺旗",21773:"辉县",21777:"云梦",21778:"黔东南",21783:"嘉祥",21790:"张北",21795:"滑县",21807:"丘北",21812:"内乡",21815:"阳新",21818:"广水",21858:"怀来",21860:"太谷",21863:"阿拉善右旗",21871:"泾县",21872:"容城",21883:"汶川",21885:"合浦",21896:"华县",21897:"深州",21898:"翁牛特旗",21902:"闽侯",21903:"平江",21908:"安国",21914:"南陵",21917:"行唐",21929:"兴和",21954:"漳浦",21962:"平塘",21976:"惠东",21994:"和县",21996:"利津",22001:"仁寿",22005:"大城",22012:"罗源",22024:"绥滨",22026:"西乌旗",22031:"毕节",22033:"铜仁",62441:"永定"}}),define("StoreManage",["TuanApp","TuanStore","CityListData","StringsData"],function(e,t,n,r){var i=t.GroupSearchStore.getInstance(),s=t.GroupPositionFilterStore.getInstance(),o=t.GroupCategoryFilterStore.getInstance(),u=t.TuanHistoryCityListStore.getInstance(),a=t.GroupSortStore.getInstance(),f=t.TuanCityListStore.getInstance(),l=t.GroupGeolocation.getInstance(),c=t.TuanHistoryKeySearchStore.getInstance(),h=t.GroupCustomFilters.getInstance(),p={clearSpecified:function(e){e&&i.setAttr("sortRule",2),e&&i.setAttr("sortType",0),!e&&h.remove(),!e&&i.setAttr("ctype",0),!e&&i.setAttr("weekendsAvailable",0),s.remove(),a.remove(),this.setCurrentKeyWord(!1),i.setAttr("qparams",this.getGroupQueryParam()),i.removeAttr("pos")},clearAll:function(){this.clearSpecified(),i.remove(),o.remove()},isNearBy:function(){return i.getAttr("nearby")||u.getAttr("nearby")},addHistoryCity:function(e,t){var n=u.get(),i=[];n&&n.list&&$.isArray(n.list)&&(i=n.list);var s,o=0;$.each(i,function(t,n){return n!=e?!0:(s=n,o=t,!1)}),s&&s==e?(i.splice(o,1),i.unshift(e)):(i.unshift(e),i.length>r.MAX_KEYWORDS_HISTORY&&i.pop()),u.setAttr("list",i)},findHistoryCity:function(e){var t=u.get(),n=[];if(!e){var r=f.get();if(!r)return;e=r.cities||r}if(t&&t.list){var i=t.list.length>3?3:t.list.length;for(var s=0;s<i;s++){var o=!1,a=t.list[s],l=this.findCityInfoById(a,e);l&&n.push(l)}}return n},getCityCount:function(e){if(!e){var t=f.get();if(!t)return;e=t.cities||t}var n=0;if(e&&e.cities&&e.cities.length>0)for(var r=0,i=e.cities.length,s;r<i;r++)s=e.cities[r],s&&s.tag&&s.tag!="热门"&&(n+=s.cities.length);return n},findCityInfoById:function(e,t,r){var i;if(!t){i=f.get();if(!i)return{CityID:e,name:n[e]||r,cGroups:""};t=i.cities||i}for(var s=0,o=t.length,u;s<o;s++){u=t[s];if(u.tag=="热门"&&u.cities)for(var a in u.cities){var l=u.cities[a];if(l.id==e)return l}}for(var s=0,o=t.length,u;s<o;s++){u=t[s];if(u.tag!="热门"&&u.cities)for(var a in u.cities){var l=u.cities[a];if(l.id==e)return l}}return!1},setCurrentCity:function(e){if(e){var t=l.get();if(t&&t.gps){var n=e.CityID||e,r=this.findCityInfoById(n);if(r)return t.gps.CityId=e.CityID,t.gps.CityName=r.name,t.gps.Groups=r.cGroups,l.setAttr("gps",t.gps),!0;e.CityID&&e.CityName&&(t.gps.CityId=e.CityID,t.gps.CityName=e.CityName,t.gps.Groups=0,l.setAttr("gps",t.gps))}}return!1},getCurrentCity:function(){var e=l.get();return e&&e.gps&&+e.gps.CityId>0?e.gps:!1},addHistoryKeyWord:function(e,t,n){var i=c.get(),o=s.getAttr("type"),u=[],a,f=0;i&&i.list&&$.isArray(i.list)&&(u=i.list),$.each(u,function(t,n){return n.id!=e?!0:(a=n,f=t,!1)}),a&&a.id==e?(u.splice(f,1),u.unshift({id:e,word:t,type:n})):(u.unshift({id:e,word:t,type:n}),u.length>r.MAX_KEYWORDS_HISTORY&&u.pop()),c.remove(),c.setAttr("list",u),this.setCurrentKeyWord({id:e,word:t,type:n}),(o<0||o=="5")&&(n=="zone"||n=="markland")&&s.remove(),o=="4"&&n=="location"&&s.remove()},getHistoryKeyWord:function(){var e=c.get(),t=[];return e&&e.list&&(t=e.list),t},setCurrentKeyWord:function(e){c.setAttr("key",e)},removeCurrentKeyWord:function(){c.removeAttr("key")},getCurrentKeyWord:function(){var e=c.get();return e?e.key:!1},getGroupQueryParam:function(){var e=[],t=h.get(),n=s.get(),r=t&&t.price&&t.price.val;r&&e.push({type:1,value:r});var i=t&&t.star;if(i&&!$.isEmptyObject(i)){var a=[],f;for(var f in i)a.push(f);e.push({type:2,value:a.join(",")})}var c=t&&t.brand&&t.brand.val;c&&e.push({type:3,value:c});var p=t&&t.trait&&t.trait.val;p&&e.push({type:14,value:p});var d=l.get()&&l.get().gps,v=t&&t.distance&&t.distance.val;u.getAttr("nearby")&&d?e.push({type:9,value:d.lat+"|"+d.lng+(v?"|"+v:"")}):v&&e.push({type:9,value:v});var m=t&&t.day&&t.day.val;m&&e.push({type:14,value:m});var g=t&&t.multiShop;g==1&&e.push({type:14,value:"102|10201"});var y=t&&t.voucher;y==1&&e.push({type:14,value:"102|10202"});var b=o.get();b&&b.subVal&&e.push({type:14,value:b.subVal}),n=n?n:{type:"",val:""},n&&n.type&&+n.type>0&&n.val&&n.val!=""&&e.push({type:n.type,name:n.name,value:n.val});var w=this.getCurrentKeyWord();if(w){var E=(w.type||"").toString().toLowerCase(),S=w.id||w.word,x={hotelid:18,zone:5,hotelgroupid:3,location:4,activity:11,district:16,markland:17};E?/\D/.test(E)&&(x[E]?E=x[E]:E=7):E=7,e.push({type:E,value:S})}return e},saveQueryString:function(e){var t=Lizard.P,s=t("ctype"),a=t("price"),f=t("star"),c=t("kwd"),p=t("place"),d=t("lat"),v=t("lng")||t("lon"),m=t("cityid"),g=t("cityname"),y=t("sort");m&&m!=i.getAttr("ctyId")&&(this.clearAll(),u.remove()),m&&(i.setAttr("ctyId",m),g=g||n[m]||"",i.setAttr("ctyName",g));if(d&&+d>0&&v&&+v>0&&p&&p!=""){l.setAttr("gps",{address:p,location:v+","+d,city:g,lng:+v,lat:+d}),u.setAttr("nearby",!0),m&&(this.setCurrentCity({CityID:m}),this.addHistoryCity(m,g));var b=i.getAttr("qparams")||[];for(var w=0,E=b.length;w<E;w++)if(b[w].type==9){b.splice(w,1);break}b.push({type:9,value:d+"|"+v+"|"+r.SEARCH_DISTANCE}),i.setAttr("qparams",b)}s&&(o.remove(),i.setAttr("ctype",r.index2ctype[s])),f&&s==1&&h.setAttr("star",f.replace(",","|")),a&&h.setAttr("price",a),c&&(c=c.split("|"),this.addHistoryKeyWord(c[1],c[0],c[2]));if(y){var S=y.indexOf("/")>-1?"/":"|";y=y.split(S),i.setAttr("sortRule",y[0]),i.setAttr("sortType",y[1]||1)}e&&e()},getCityIdByName:function(e){var t;return e&&(t=n[e]),!1}};return p}),define("TuanFilters",["cBase","cUtility","cWidgetFactory","cUIMask","cUIScroll","DropDown","Tab","StringsData","TuanModel","TuanStore","StoreManage"],function(e,t,n,r,i,s,o,u,a,f,l){var c,h=$.extend,p={weizhiquyu:"位置区域"},d=!1,v=t.getAppSys()==="youth",m=f.GroupCategoryFilterStore.getInstance(),g=f.GroupSortStore.getInstance(),y=f.GroupSearchStore.getInstance(),b=a.TuanConditionModel.getInstance(),w=f.GroupConditionStore.getInstance(),E=f.GroupCustomFilters.getInstance(),S=f.TuanHistoryCityListStore.getInstance(),x=f.GroupPositionFilterStore.getInstance(),T=["price","day","trait","distance","brand"],N=_.template(['<%if(["all", "hotel", "catering"].indexOf(category)!=-1){%>','<div class="pop_filter_chkitem" data-type="weekendsAvailable" data-text="周末可用">周末可用','<div class="pop_filter_label">','<input type="checkbox" id="weekends"<%if(weekendsAvailable==1){%> checked<%}%> /><label for="weekends"></label>',"</div>","</div>","<%}%>",'<%if(category=="hotel"){%>','<div class="pop_filter_chkitem" data-type="multiShop" data-text="多店可用">多店可用','<div class="pop_filter_label">','<input type="checkbox" id="multiShop"<%if(multiShop==1){%> checked<%}%> /><label for="multiShop"></label>',"</div>","</div>",'<div class="pop_filter_chkitem" data-type="voucher" data-text="代金券">代金券','<div class="pop_filter_label">','<input type="checkbox" id="voucher"<%if(voucher==1){%> checked<%}%> /><label for="voucher"></label>',"</div>","</div>","<%}%>"].join("")),C=_.template(['<ul class="pop_filter_tabs">','<li data-tab="price"><i class="pop_filter_point"<%if(!customdata.price || (customdata.price && customdata.price.val == "1|1")){%> style="display:none"<%}%>></i>价格</li>','<%if(category=="vacation"){%><li data-tab="day"><i class="pop_filter_point"<%if(!customdata.day){%> style="display:none"<%}%>></i>天数</li><%}%>','<%if(category=="hotel"){%><li data-tab="star"><i class="pop_filter_point"<%if(!customdata.star){%> style="display:none"<%}%>></i>星级</li><%}%>','<%if(category=="hotel"){%><li data-tab="brand"><i class="pop_filter_point"<%if(!customdata.brand){%> style="display:none"<%}%>></i>品牌</li><%}%>','<%if(category=="hotel"){%><li data-tab="trait"><i class="pop_filter_point"<%if(!customdata.trait){%> style="display:none"<%}%>></i>特色</li><%}%>','<%if((isNearBy && ["all", "hotel", "catering", "ticket", "entertainment"].indexOf(category)!=-1) || isUniversityNearBy){%><li data-tab="distance"><i class="pop_filter_point"<%if(!customdata.distance){%> style="display:none"<%}%>></i>距离</li><%}%>',"</ul>"].join("")),k=_.template(['<li data-filter="brand"<%if(!val){%> class="choosed"<%}%>><div class="txt01">不限</div></li>',"<%_.each(arr, function(a,i){%>",'<li data-filter="brand" data-value="<%=a.val%>" data-text="<%=a.txt%>"<%if(a.val==val){%> class="choosed"<%}%>>','<div class="txt01"><%=a.txt%></div>',"</li>","<%})%>"].join("")),L=_.template(['<li data-filter="trait"<%if(!val){%> class="choosed"<%}%>><div class="txt01">不限</div></li>',"<%_.each(arr, function(a,i){%>",'<li data-filter="trait" data-value="<%=a.val%>" data-text="<%=a.txt%>"<%if(a.val==val){%> class="choosed"<%}%>>','<div class="txt01"><%=a.txt%></div>',"</li>","<%})%>"].join("")),A=_.template(['<div class="pop_filter_lefttab">','<ul class="pop_filter_tabs">',"<%_.each(tuanType, function(v){%>",'<li class="J_categoryTabLabel<%if(v.val==tuanTypeVal){%> choosed<%}%>"><%=v.txt%></li>',"<%})%>","</ul>","</div>",'<div class="pop_filter_righttab">',"<%_.each(tuanType, function(v){%>",'<div class="J_categoryTabPanel" style="height:285px;<%if(v.val!=tuanTypeVal){%>display:none<%}%>">','<ul class="pop_filter_baselist" style="min-height:285px">','<li data-type="<%=v.val%>"<%if(v.val==tuanTypeVal && typeof subVal == "undefined"){%> class="choosed"<%}%>><div class="txt01"><%=v.val>0 ? "全部" : ""%><%=v.txt%></div><span class="txt02"><%=v.groupCount%></span></li>',"<%_.each(subTuanType, function(s){%>","<%if (s.parentType == v.val){%>",'<li data-type="<%=v.val%>" data-value="<%=s.val%>" data-name="<%=s.txt%>"<%if(typeof subVal !== "undefined" && s.val==subVal){%> class="choosed"<%}%>><div class="txt01"><%=s.txt%></div><span class="txt02"><%=s.groupCount%></span></li>',"<%}%>","<%})%>","</ul>","</div>","<%})%>","</div>"].join("")),O=_.template(['<div class="pop_filter_lefttab">','<ul class="pop_filter_tabs">','<%if(Zone.length){%><li class="J_positionTabLabel<%if(curr.type==5){%> choosed<%}%>">商业区</li><%}%>','<%if(Location.length){%><li class="J_positionTabLabel<%if(curr.type==4){%> choosed<%}%>">行政区</li><%}%>','<%if(tuanType!=7 && AirportStation.length){%><li class="J_positionTabLabel<%if(curr.type==-4){%> choosed<%}%>">机场车站</li><%}%>','<%if(tuanType!=7 && SubwayLine.length){%><li class="J_positionTabLabel<%if(curr.type==-3){%> choosed<%}%>">地铁线</li><%}%>','<%if(tuanType!=7 && Attraction.length){%><li class="J_positionTabLabel<%if(curr.type==-2){%> choosed<%}%>">景点</li><%}%>','<%if(tuanType!=7 && College.length){%><li class="J_positionTabLabel<%if(curr.type==-1){%> choosed<%}%>">大学周边</li><%}%>',"</ul>","</div>",'<div class="pop_filter_righttab">',"<%if(Zone.length){%>",'<div class="J_positionTabPanel"<%if(curr.type!=5){%> style="height:285px;display:none"<%}%>>','<ul class="pop_filter_baselist" style="min-height:285px">','<li<%if(!curr.val||curr.type!=5){%> class="choosed"<%}%>><div class="txt01">不限</div></li>',"<%_.each(Zone, function(val){%>",'<li data-type="5" data-value="<%=val.val%>" data-pos=\'<%=JSON.stringify(val.pos)%>\' data-text="<%=val.txt%>"<%if(curr.type==5&&curr.val==val.val){%> class="choosed"<%}%>><div class="txt01"><%=val.txt%></div><span class="txt02"><%=val.groupCount%></span></li>',"<%})%>","</ul>","</div>","<%}%>","<%if(Location.length){%>",'<div class="J_positionTabPanel"<%if(curr.type!=4){%> style="height:285px;display:none"<%}%>>','<ul class="pop_filter_baselist" style="min-height:285px">','<li<%if(!curr.val||curr.type!=4){%> class="choosed"<%}%>><div class="txt01">不限</div></li>',"<%_.each(Location, function(val){%>",'<li data-type="4" data-value="<%=val.val%>" data-text="<%=val.txt%>"<%if(curr.type==4&&curr.val==val.val){%> class="choosed"<%}%>><div class="txt01"><%=val.txt%></div><span class="txt02"><%=val.groupCount%></span></li>',"<%})%>","</ul>","</div>","<%}%>","<%if(tuanType!=7 && AirportStation.length){%>",'<div class="J_positionTabPanel"<%if(curr.type!=-4){%> style="height:285px;display:none"<%}%>>','<ul class="pop_filter_baselist" style="min-height:285px">','<li<%if(!curr.val||curr.type!=-4){%> class="choosed"<%}%>><div class="txt01">不限</div></li>',"<%_.each(AirportStation, function(val){%>",'<li data-type="-4" data-value="<%=val.val%>" data-pos=\'<%=JSON.stringify(val.pos)%>\' data-text="<%=val.txt%>"<%if(curr.type==-4&&curr.val==val.val){%> class="choosed"<%}%>><div class="txt01"><%=val.txt%></div></li>',"<%})%>","</ul>","</div>","<%}%>","<%if(tuanType!=7 && SubwayLine.length){%>",'<div class="J_positionTabPanel"<%if(curr.type!=19){%> style="height:285px;display:none"<%}%> id="J_subwayLine">','<ul class="pop_filter_baselist" style="min-height:285px">','<li<%if(!curr.line){%> class="backwards"<%}%>><div class="txt01">不限</div></li>',"<%_.each(SubwayLine, function(val){%>",'<li data-type="-5" data-value="<%=val.val%>" data-text="<%=val.txt%>" class="arr_r<%if(curr.line==val.val){%> backwards<%}%>"><div class="txt01"><%=val.txt%></div><span class="txt03"><%if(curr.line==val.val&&curr.type==-3){%><%=curr.name%><%}%></span></li>',"<%})%>","</ul>","</div>","<%}%>","<%if(tuanType!=7 && Attraction.length){%>",'<div class="J_positionTabPanel"<%if(curr.type!=-2){%> style="height:285px;display:none"<%}%>>','<ul class="pop_filter_baselist" style="min-height:285px">','<li<%if(!curr.val||curr.type!=-2){%> class="choosed"<%}%>><div class="txt01">不限</div></li>',"<%_.each(Attraction, function(val){%>",'<li data-type="-2" data-value="<%=val.val%>" data-pos=\'<%=JSON.stringify(val.pos)%>\' data-text="<%=val.txt%>"<%if(curr.type==-2&&curr.val==val.val){%> class="choosed"<%}%>><div class="txt01"><%=val.txt%></div></li>',"<%})%>","</ul>","</div>","<%}%>","<%if(tuanType!=7 && College.length){%>",'<div class="J_positionTabPanel"<%if(curr.type!=-1){%> style="height:285px;display:none"<%}%>>','<ul class="pop_filter_baselist" style="min-height:285px">','<li<%if(!curr.pos||curr.type!=-1){%> class="choosed"<%}%>><div class="txt01">不限</div></li>',"<%_.each(College, function(val){%>",'<li data-type="-1" data-pos=\'<%=JSON.stringify(val.pos)%>\' data-text="<%=val.txt%>"<%if(curr.type==-1&&curr.pos.lat==val.lat&&curr.pos.lon==val.lon){%> class="choosed"<%}%>><div class="txt01"><%=val.txt%></div></li>',"<%})%>","</ul>","</div>","<%}%>",'<div class="J_positionTabPanel" style="height:285px;overflow:hidden;display:none" id="J_subwayStation">','<ul class="pop_filter_baselist" style="min-height:285px;"></ul>',"</div>","</div>"].join("")),M=_.template(['<li data-type="-3"><div class="pop_filter_back">返回</div></li>','<li data-type="19" data-line="<%=lineId%>"<%if(curr.val==lineId&&curr.type==19){%> class="choosed"<%}%> data-text="<%=lineName%>"><div class="txt01">全线</div></li>',"<%_.each(arr, function(a,i){%>",'<li data-type="-3" data-value="<%=a.val%>" data-line="<%=lineId%>" data-pos=\'<%=JSON.stringify(a.pos)%>\' data-text="<%=a.txt%>"<%if(curr.val==a.val){%> class="choosed"<%}%>>','<div class="txt01"><%=a.txt%></div>',"</li>","<%})%>"].join(""));return c=new e.Class({__propertys__:function(){var e=this;this.options={},this.page=null,this.mask=new r({onCreate:function(){var t=this;this.root.on("click",function(){e.options.categoryPanel.hide(),e.options.positionPanel.hide(),e.options.filterPanel.hide(),e._categoryStatus=!1,e._positionStatus=!1,e._customFilterStatus=!1,t.hide()})}})},initSort:function(){var e=this,t=g.getAttr("sortTypeIndex")||0,n=y.getAttr("sortRule"),r=y.getAttr("sortType"),i=e.options;this.sort=new s({trigger:i.sortTrigger,panel:i.sortPanel,label:i.sortLabel,selectedIndex:t,selectedItemCls:"choosed",onShow:function(){i.categoryPanel.hide(),i.positionPanel.hide(),i.filterPanel.hide(),e.mask.hide(),e._categoryStatus=!1,e._positionStatus=!1,e._customFilterStatus=!1},onSelect:function(t){var n=$(t),r=n.attr("data-id"),i=n.attr("data-type"),s=+this.selectedIndex>=0?this.selectedIndex:0;g.setAttr("sortTypeIndex",s),y.setAttr("sortRule",r),r==2&&v&&(i=8),y.setAttr("sortType",i),e.getListData()}});var o=this.sort.panel.find('[data-id="'+n+'"][data-type="'+r+'"]');o=o&&o[0]||$(this.sort.getItemByIndex(t))[0],this.sort.select(o,!0),i.sortPanel.on("touchmove",function(e){e.preventDefault()})},initCategory:function(){var e=this,t=this.options.categoryTrigger,n=this.options.categoryPanel;this.renderCategory(),t.on("click",function(){e._categoryStatus?(n.hide(),e.mask.hide(),e._categoryStatus=!1):(e.options.positionPanel.hide(),e.options.filterPanel.hide(),e._positionStatus=!1,e._customFilterStatus=!1,e.sort.hide(),n.show(),e.mask.show(),n.css({"-webkit-transform":"translate(0, 30px) translateZ(0)",opacity:0}),n.animate({"-webkit-transform":"translate(0, -8px) translateZ(0)",opacity:1}),e._categoryStatus=!0,e._categoryInited==undefined&&(e.initCategoryTab(),e._categoryInited=!0))}),n.on("touchmove",function(e){e.preventDefault()})},initCategoryTab:function(){var e=this,t=this.page.$el,n=t.find(".J_categoryTabLabel"),r=t.find(".J_categoryTabPanel");this.categoryTab=new o({label:n,panel:r,isScroll:!0,labelSelectedClass:"choosed",labelSelectedIndex:m.getAttr("tuanTypeIndex")||0,itemClass:".pop_filter_baselist li",itemSelectedClass:"choosed",onSelect:function(t){var n=t.data("type"),i=t.data("value")||"",s=t.data("name"),o=u.groupType[n];r.find(".choosed").removeClass("choosed"),t.addClass("choosed"),e.page.updateTitle(o.name),e.page.searchKeywordInput.val(""),n==7&&S.removeAttr("nearby");var a=E.getAttr("distance");l.clearSpecified(!1),a&&l.isNearBy()&&E.setAttr("distance",a),e.clearCustomFilter(!0),m.setAttr("tuanType",n),m.setAttr("category",o.category),m.setAttr("name",o.name),m.setAttr("tuanTypeIndex",o.index),m.setAttr("subVal",i),m.setAttr("subName",s),y.setAttr("qparams",l.getGroupQueryParam()),y.setAttr("ctype",n),e.options.categoryTrigger.html(s||u.groupType[n].name),e.resetPosition(n),e.getListData(),e.renderFilter(o.category),e.mask.hide(),e.options.categoryPanel.hide(),e._categoryStatus=!1}})},renderCategory:function(){var e={},t=w.get(),n=m.get()||{},r=this.options.categoryTrigger;e.tuanTypeVal=n.tuanType||y.getAttr("ctype")||0,n.subVal&&(e.subVal=n.subVal),r.html(n.subName||u.groupType[e.tuanTypeVal].name);if(t&&$.isArray(t.categroy)&&t.categroy.length>0){var i=t.categroy[0].groupCondition;i&&$.isArray(i)&&i.length>0&&(e.tuanType=$.grep(i,function(e,t){return e.type==16}),e.subTuanType=$.grep(i,function(e,t){return e.type==32}),this.options.categoryPanel.html(A(e)))}},updateCategoryName:function(){var e=m.getAttr("tuanTypeIndex")||0,t=m.getAttr("tuanType")||0;this.categoryTab?this.categoryTab.switch(e):this.renderCategory(),this.options.categoryTrigger.html(u.groupType[t].name)},initPosition:function(){var e=this,t=this.options.positionTrigger,n=this.options.positionPanel;this.renderPosition(),t.on("click",function(){if(d)return;e._positionStatus?(n.hide(),e.mask.hide(),e._positionStatus=!1):(e.options.categoryPanel.hide(),e.options.filterPanel.hide(),e._categoryStatus=!1,e._customFilterStatus=!1,e.sort.hide(),n.show(),e.mask.show(),n.css({"-webkit-transform":"translate(0, 30px) translateZ(0)",opacity:0}),n.animate({"-webkit-transform":"translate(0, -8px) translateZ(0)",opacity:1}),e._positionInited==undefined&&(e.initPositionTab(),e._positionInited=!0),e._positionStatus=!0)}),n.on("touchmove",function(e){e.preventDefault()})},initPositionTab:function(){function c(e){r.find(".choosed").removeClass("choosed"),r.find("li:first-child").addClass("choosed"),e.addClass("choosed").siblings().removeClass("choosed")}function h(){s.find(".backwards").removeClass("backwards"),s.find(".txt03").text("")}function d(e){c(e),h()}var e=this,t=this.page.$el,n=t.find(".J_positionTabLabel"),r=t.find(".J_positionTabPanel"),s=t.find("#J_subwayLine"),a=t.find("#J_subwayStation"),f={5:0,4:1,"-4":2,"-3":3,19:3,"-2":4,"-1":5},v=new o({label:n,panel:r,isScroll:!0,labelSelectedClass:"choosed",labelSelectedIndex:f[x.getAttr("type")]||0,itemClass:".pop_filter_baselist li",itemSelectedClass:"choosed",onSwitch:function(){a.hide()},onSelect:function(t){var n=t.data("type"),r=t.data("text"),o=y.get(),f=l.getCurrentKeyWord();if(l.isNearBy()){S.setAttr("nearby",!1),E.removeAttr("distance");var c=e.page.$el.find('#J_filterTabLabel li[data-tab="distance"]'),h=e.page.$el.find('#J_filterTabPanel div[data-tab="distance"]');c.hide(),h.hide(),c.find("i").hide(),e.updateCustomFilterIcon(),y.removeAttr("pos")}f&&((n<0||n=="5")&&(f.type=="zone"||f.type=="markland")&&l.removeCurrentKeyWord(),n=="4"&&f.type=="location"&&l.removeCurrentKeyWord());if(o){if(+o.ctyId>0){var v=l.findCityInfoById(o.ctyId);v&&y.setAttr("ctyName",v.name)}o.edate||y.setAttr("edate",o.bdate)}if(r)switch(n){case 5:d(t),x.set({type:5,name:r,val:t.data("value"),pos:t.data("pos")});break;case 4:d(t),x.set({type:4,name:r,val:t.data("value")});break;case 19:d(t);var m=t.data("line"),g=s.find('li[data-value="'+m+'"]');x.set({type:19,name:r,line:m,val:m}),a.hide(),s.show(),s.find(".txt03").text(""),s.find("li:first-child").removeClass("choosed"),g.addClass("backwards").siblings().removeClass("backwards");break;case-5:var m=t.data("value");if(m==a.data("line")){s.hide(),a.show();return}var b=e.getSubwayStation(m,r),w=a.find("ul");s.hide(),a.data("line",m).show(),w.html(M(b));var T=new i({wrapper:a,scroller:w});T.scrollTo(0,0,0);return;case-3:case-4:case-2:case-1:var N={type:n,name:r,pos:t.data("pos")},C=t.data("value");C&&(N.val=C);if(n==-3){var m=t.data("line"),g=s.find('li[data-value="'+m+'"]');N.line=m,s.show(),a.hide(),s.find("li:first-child").removeClass("choosed"),s.find(".txt03").text(""),g.addClass("backwards").siblings().removeClass("backwards"),g.find(".txt03").text(r),t.addClass("choosed").siblings().removeClass("choosed")}else d(t);x.set(N),E.setAttr("distance",{val:1,txt:"1公里内"})}else{if(n==-3){s.show(),a.hide();return}d(t),x.remove(),E.removeAttr("distance")}e.updatePositionName(r||p.weizhiquyu);if(n<0){var k=y.getAttr("ctype");e.renderFilter(u.groupType[k].category,!0),e.updateCustomFilterIcon()}var L=l.getGroupQueryParam();y.setAttr("qparams",L),x.setAttr("ctyId",o.ctyId),e.getListData(),e.mask.hide(),e.options.positionPanel.hide(),e._positionStatus=!1}})},renderPosition:function(e,t){var n={Zone:[],Location:[],College:[],AirportStation:[],SubwayLine:[],Attraction:[]},r=this.options.positionPanel,i=this.options.positionTrigger,s=w.get();n.curr=x.get()||{},this.updatePositionName(),e=e||y.getAttr("ctype"),n.tuanType=e;if(s&&$.isArray(s.categroy)&&s.categroy.length>0){var o=$.grep(s.categroy,function(t,n){return t.ctype==e});if(o&&$.isArray(o)&&o.length>0){var u=s.categroy[0].groupCondition;u&&$.isArray(u)&&u.length>0&&($.each(u,function(e,t){switch(t.type){case 2:n.Location.push(t);break;case 4:n.Zone.push(t);break;case 8:n.College.push(t);break;case 256:case 512:n.AirportStation.push(t);break;case 1024:n.SubwayLine.push(t);break;case 4096:n.Attraction.push(t)}}),n.Zone.length||n.Location.length||n.College.length?(i.show(),r.html(O(n)),t&&t()):i.hide())}else i.hide()}},resetPosition:function(e){var t=this,n=1;n|=2,n|=4,n|=8,n|=64,n|=128,n|=256,n|=512,n|=1024,n|=2048,n|=4096,n|=8192,d=!0,this.options.positionTrigger.html(p.weizhiquyu),b.setParam({ctyId:y.getAttr("ctyId"),categroy:e,type:n}),b.excute(function(){t.renderPosition(e,function(){d=!1,t._positionInited=undefined})},function(e){},!1,this)},updatePositionName:function(e){var t=this.options.positionTrigger;if(!e){var n=x.get()||{},r=n.name;n.type==-6&&(r=p.weizhiquyu),t.html(r||p.weizhiquyu)}else t.html(e)},initCustomFilter:function(){var e=this,t=e.options.customFilter,n=this.page.$el,r=n.find("#J_filterPanel"),i=n.find("#J_pricePanel"),s=n.find("#J_checkboxWrap"),o=n.find(".pop_filter_cancel"),u=n.find(".pop_filter_sure"),a=n.find(".pop_filter_clear");this.renderFilter(m.getAttr("category")),this.updateCustomFilterIcon(),t.on("click",function(){e._customFilterStatus?(r.hide(),e.mask.hide(),e._customFilterStatus=!1):(e.sort.hide(),e.options.categoryPanel.hide(),e.options.positionPanel.hide(),e._categoryStatus=!1,e._positionStatus=!1,r.show(),e.mask.show(),r.css({"-webkit-transform":"translate(0, 30px) translateZ(0)",opacity:0}),r.animate({"-webkit-transform":"translate(0, -8px) translateZ(0)",opacity:1}),e._customFilterInited==undefined&&(e.initFilterTab(),e._customFilterInited=!0),e._customFilterStatus=!0)}),o.on("click",function(){r.hide(),e.mask.hide(),e._customFilterStatus=!1}),u.on("click",function(){r.hide(),e.mask.hide(),e.sureCustomFilter(),e._customFilterStatus=!1}),a.on("click",function(){e.clearCustomFilter(),e._customFilterStatus=!1}),s.on("click","div[data-type]",function(t){if(t.target.tagName=="LABEL")return;var n=$(t.currentTarget),r=n.data("type"),i=n.find("input:checked").length;r=="weekendsAvailable"?y.setAttr("weekendsAvailable",i?1:0):E.setAttr(r,i?1:0),a[e.customFilterSelectedCount()?"removeClass":"addClass"]("sta-disabled")}),r.on("touchmove",function(e){e.preventDefault()})},initFilterTab:function(){var e=this,t=this.page.$el,n=t.find("#J_filterTabLabel"),r=t.find("#J_filterTabPanel"),i=t.find("input[data-value]"),s=t.find(".pop_filter_clear");n.on("click","li",function(t){var i=$(t.currentTarget);if(i.hasClass("choosed"))return;var s=i.data("tab");n.find(".choosed").removeClass("choosed"),i.addClass("choosed"),r.find("div[data-tab]").hide(),e.renderTabWrap(s,r,!0)}),r.on("click",".pop_filter_baselist li",function(t){var r=$(t.currentTarget),o=r.data("value"),u=r.data("text"),a=r.data("filter");if(T.indexOf(a)>-1)r.addClass("choosed").siblings(".choosed").removeClass("choosed"),o?E.setAttr(a,{val:o,txt:u}):E.removeAttr(a),n.find('li[data-tab="'+a+'"]>i')[o?"show":"hide"]();else if(a=="star")if(!o)i.each(function(e,t){e>0&&(t.checked=!1)}),E.removeAttr("star"),n.find('li[data-tab="star"]>i').hide();else{var o=o.toString(),f=E.getAttr("star")||{};r.parent().find("input:checked").length?i[0].checked=!1:i[0].checked=!0,r.find("input:checked").length?f[o]=u:delete f[o],E.setAttr("star",f),n.find('li[data-tab="star"]>i')[$.isEmptyObject(f)?"hide":"show"]()}s[e.customFilterSelectedCount()?"removeClass":"addClass"]("sta-disabled")})},renderTabWrap:function(e,t,n){var r=E.get(),s=t.find('div[data-tab="'+e+'"]');n&&s.show();switch(e){case"price":y.getAttr("ctype")==7?(s.find('li[data-ptype="0"]').hide(),s.find('li[data-ptype="1"]').show()):(s.find('li[data-ptype="0"]').show(),s.find('li[data-ptype="1"]').hide()),s.find(".choosed").removeClass("choosed"),r&&r.price?s.find('li[data-value="'+r.price.val+'"]').addClass("choosed"):s.find('li[data-value=""]').addClass("choosed");break;case"day":s.find(".choosed").removeClass("choosed"),r&&r.day?s.find('li[data-value="'+r.day.val+'"]').addClass("choosed"):s.find('li[data-value=""]').addClass("choosed");break;case"star":if(r&&r.star){var o=r.star;s.find("input:checked")[0].checked=!1,_.each(o,function(e,t){s.find('input[data-value="'+t+'"]')[0].checked=!0})}else s.find("input[data-value]").each(function(e,t){t.checked=e<=0});break;case"brand":var u=s.find("#J_brand"),a=u.parent();a.css({overflow:"hidden","max-height":"295px"}),u.html(k(this.getDataFromCondition("brand",1))),new i({wrapper:a,scroller:u});break;case"trait":var f=s.find("#J_trait"),a=f.parent();a.css({overflow:"hidden","max-height":"295px"}),f.html(L(this.getDataFromCondition("trait",8192))),new i({wrapper:a,scroller:f});break;case"distance":s.data("scrolled")||(new i({wrapper:s,scroller:s.find("ul")}),s.data("scrolled","true")),s.find(".choosed").removeClass("choosed"),r&&r.distance?s.find('li[data-value="'+r.distance.val+'"]').addClass("choosed"):s.find('li[data-value=""]').addClass("choosed")}},renderFilter:function(e,t){var n=this.page.$el,r=E.get(),i=n.find("#J_checkboxWrap"),s=n.find("#J_filterTabLabel"),o=n.find("#J_filterTabPanel"),u={category:e,weekendsAvailable:y.getAttr("weekendsAvailable"),multiShop:r&&r.multiShop,voucher:r&&r.voucher},a=N(u);a?i.show().html(a):i.hide(),s.html(C({category:e||"all",isNearBy:l.isNearBy(),customdata:r||{},isUniversityNearBy:t})),o.find("div[data-tab]").hide(),this.renderTabWrap(s.find("li:first-child").addClass("choosed").data("tab"),o,!0)},getDataFromCondition:function(e,t){var n={val:"",arr:[]},r=w.get(),i=E.getAttr(e);i&&i.val&&(n.val=i.val);if(r&&$.isArray(r.categroy)&&r.categroy.length>0){var s=r.categroy[0].groupCondition;s&&$.isArray(s)&&s.length>0&&(n.arr=$.grep(s,function(e,n){return e.type==t}))}return n},getSubwayStation:function(e,t){var n={lineId:e,lineName:t,arr:[]},r=w.get();n.curr=x.get()||{};if(r&&$.isArray(r.categroy)&&r.categroy.length>0){var i=r.categroy[0].groupCondition;i&&$.isArray(i)&&i.length>0&&(n.arr=$.grep(i,function(t,n){return t.parentType==e}))}return n},clearCustomFilter:function(e){var t=this,n=l.isNearBy(),r=this.page.$el,i=r.find(".pop_filter_clear");if(i.hasClass("sta-disabled"))return;var s=r.find("#J_filterTabLabel"),o=r.find("#J_filterTabPanel");y.removeAttr("weekendsAvailable"),E.removeAttr("multiShop"),E.removeAttr("voucher");var u=T.concat(["star"]);e&&n&&u.splice(u.indexOf("distance"),1),_.each(u,function(e,n){E.removeAttr(e),t.renderTabWrap(e,o,!1)}),s.find(".choosed").removeClass("choosed"),s.find("li i").hide(),o.find("div[data-tab]").hide(),this.renderTabWrap(s.find("li:first-child").addClass("choosed").data("tab"),o,!0),r.find("#J_checkboxWrap input:checked").each(function(e,t){t.checked=!1}),this.updateCustomFilterIcon()},sureCustomFilter:function(){var e=y.get(),t=l.getGroupQueryParam();e&&(e.edate||y.setAttr("edate",e.bdate)),y.setAttr("qparams",t),this.getListData(),this.updateCustomFilterIcon()},customFilterSelectedCount:function(){var e=!1,t=l.getGroupQueryParam(),n=y.getAttr("weekendsAvailable"),r=t&&t.length>0&&t.filter(function(t){!e&&(e=parseInt(t.type,10)===9);var n=parseInt(t.type,10);return n==14&&t.value==m.getAttr("subVal")?!1:[1,2,3,9,14].indexOf(n)!==-1}).length;return n==1&&(r+=1),!E.getAttr("distance")&&e&&(r-=1),E.getAttr("price.val")=="1|1"&&(r-=1),r>0?r:0},updateCustomFilterIcon:function(){var e=this,t=this.page.$el,n=e.options.customFilter,r=e.customFilterSelectedCount(),i=t.find(".pop_filter_clear");n.find(".fil_num").text(r)[r>0?"show":"hide"](),i[r>0?"removeClass":"addClass"]("sta-disabled")},getListData:function(){y.setAttr("pageIdx","1"),this.page.isLoading=!0,window.scrollTo(0,0),this.page.showLoading(),this.page.hideBottomLoading(),this.page.getGroupListData()},initialize:function(e){h(this.options,e),this.page=this.options.page,this.initCategory(),this.initPosition(),this.initSort(),this.initCustomFilter()}}),c.getInstance=function(e){return new c(e)},c}),define("SmoothSlide",["cBase","cUICore","cWidgetFactory","libs"],function(e,t,n){function l(e){return e===Object(e)}function c(e,t,n){if(!e||$(e).data("loaded"))return;var r=new Image;r.src=e.dataset["data-src"]||e.getAttribute("data-src"),r.onload=function(){e.src=r.src,$(e).data("loaded",!0)}}var r="SmoothSlide",i=function(){},s=null,o=/\-?[0-9]+\.?[0-9]*/g,u,a=function(){var e=$.browser,t="";return t=e.webkit?"-webkit-":e.firefox?"-moz-":e.ie?"-ms-":"",t}(),f=a.replace(/\-/g,"");if(n.hasWidget(r))return;u=new e.Class({__propertys__:function(){this.options={container:s,autoplay:5e3,currentIndex:0,direction:u.LEFT,animationDuration:300,prefetch:0,placeholder:"",source:s,tpl:'<div class="cui-slide"><div class="cui-slide-imgsouter"><div class="cui-slide-imgsinter" style="width:9999px"><%for(var i=0,len=data.length;i<len;i++){%><%var item = data[i]%><div class="cui-slide-img-item"><img data-href="<%=item.href%>" data-src="<%=item.src%>" data-img-id="<%=item.id%>" data-img-title="<%=item.title%>"/></div><%}%></div></div></div>',itemCls:".cui-slide-img-item",pageSize:1,minSwipe:40,width:0,height:0,onSwitch:i,onSwitchEnd:i,onInit:i}},initialize:function(e){var t;l(e)&&(this.options=$.extend(this.options,e)),t=this.options,this.container=t.container,this.tpl=t.tpl,this.container&&this.container.length&&(this.render(t.source,t.currentIndex),this._isInteractive()&&this._bindEvents(),t.autoplay&&this._autoplay())},_isInteractive:function(){var e=this.options;return e.pageSize<e.source.length},_createLayout:function(){var e=this.source;this.container.html(_.template(this.tpl)({data:e}))},_autoplay:function(){var e=this;clearTimeout(this.__autoplayTimer),this.__autoplayTimer=setTimeout(function(){e.next(!0),e._autoplay()},this.options.autoplay)},_bindEvents:function(){var e=this._runtime,t=this.container;this.__moveHandler=$.proxy(this.__moveHandler,this),t.on("touchmove",this.__moveHandler),this.__touchStartHandler=$.proxy(this.__touchStartHandler,this),t.on("touchstart",this.__touchStartHandler),this.__touchEndHandler=$.proxy(this.__touchEndHandler,this),t.on("touchend",this.__touchEndHandler),this.__transitionEndHandler=$.proxy(this.__transitionEndHandler,this),e.root.on(f+"TransitionEnd",this.__transitionEndHandler)},_unbindEvents:function(){var e=this._runtime,t=this.container;t.off("touchmove",this.__moveHandler),t.on("touchstart",this.__touchStartHandler),t.on("touchend",this.__touchEndHandler),e.root.off(f+"TransitionEnd",this.__transitionEndHandler)},_current:0,count:function(){return this.source.length},render:function(e,t){clearTimeout(this.__autoplayTimer);var n=this.options;return this.source=e,this._createLayout(e),this.items=this.container.find(n.itemCls),this._runtime=this._getRuntimeEnv(),this.items.css("width",this._runtime.width),this._showCurrent(this._runtime.root,t),this._prefetch(n.direction),n.onInit.call(this,this._current),this},current:function(){return this._current},next:function(e){this.goto(this._current+this.options.pageSize,u.LEFT,e)},prev:function(){this.goto(this._current-this.options.pageSize,u.RIGHT)},play:function(){this.options.autoplay&&this._autoplay()},pause:function(){clearTimeout(this.__autoplayTimer)},stop:function(){clearTimeout(this.__autoplayTimer),this.goto(0)},"goto":function(e,t,n){var r=this,i=this._runtime,s=this.options,o=s.direction,a=s.autoplay&&n,f=i.count,l=i.width;a&&(e<0&&(e=f-1),e>=f&&(e=0)),e>=0&&e<f?(u.animate(i.root,o*l*this._current,o*l*e,this.options.animationDuration),this._current=e,this._prefetch(t),setTimeout(function(){r.options.onSwitch.call(r,e,r.source[e])},10)):this.goto(this._current)},_showCurrent:function(e,t){var n=this._runtime;u.translate(n.root,this.options.direction*n.width*t,0),this._current=t,this._prefetch()},_prefetch:function(e){if(this.options.prefetch<0)return;e||(e=u.LEFT);var t=this._current,n=this.options.prefetch,r,i=n*e;do r=this.items[t+n-i*e],r=r&&r.children[0],r&&c(r);while(i-=e)},_getSwipeDirection:function(e,t){var n=t-e,r=Math.abs(n),i;return r>0&&r>this.options.minSwipe&&(i=n/r),i},_getRuntimeEnv:function(){var e=this.items,t=this.options,n=$(e[0]),r=n.parent(),i=r.parent(),s=i.offset(),o=this.count();return{width:t.width||s.width,root:r,stage:i,count:o}},__touchStartHandler:function(e){var t=e.touches[0],n=this._getRuntimeEnv().root,r=n.css(a+"transform").match(o);r=r&&r[0]||0,this.__lastTouchStartPos={left:Number(r),x:t.pageX,y:t.pageY,t:+(new Date)}},__touchEndHandler:function(e){var t=this.__lastTouchStartPos,n=this._getSwipeDirection(t.x,e.changedTouches[0].pageX);this[n===u.LEFT?"next":n===u.RIGHT?"prev":"goto"]()},__transitionEndHandler:function(e){var t=this._current,n=this;setTimeout(function(){n.options.onSwitchEnd.call(n,e,t,n.source[t])},10)},__moveHandler:function(e){e.preventDefault();if(e.touches.length>1||e.scale&&e.scale!==1)return;var t=e.touches[0],n=this._getRuntimeEnv(),r=n.root,i=this.__lastTouchStartPos,s=i.left+t.pageX-i.x;u.translate(r,s,0)}}),u.LEFT=-1,u.RIGHT=1,u.translate=function(e,t,n){var r=e[0],i=r&&r.style;if(!i)return;e.css(a+"transition",n+"ms ease-out"),e.css(a+"transform","translate("+t+"px,0) translateZ(0)")},u.animate=function(e,t,n,r){this.translate(e,n,r)},n.register({name:r,fn:u})}),define("Switch",["cBase"],function(e){function n(e){this.options={wrap:null,cursor:null,cursorCls:"",turnOnCls:"active",html:"<i>关</i>",isTurnOn:!1,onChange:t},this.initialize(e),this.turn(this.isTurnOn,!0)}var t=function(){},n,r=$.extend;return n.prototype={initialize:function(e){r(this.options,e),this.isTurnOn=this.options.isTurnOn,this.wrap=this.options.wrap,this.wrap&&this.renderHTML(),this.options.cursor?this.cursor=this.options.cursor:this.cursor=this.wrap.find(this.options.cursorCls),this.bindEvents()},renderHTML:function(){this.wrap.html(this.options.html)},bindEvents:function(){var e=this.cursor,t=this;this._clickHandler=function(){t.turn()},e&&e.length&&e.parent().bind("click",this._clickHandler)},unbindEvents:function(){this.cursor.parent().unbind("click",this._clickHandler)},turn:function(e){var t,n=this.options;e===undefined?t=!this.isTurnOn:t=e;try{this.wrap&&this.wrap[t?"addClass":"removeClass"](n.turnOnCls),n.onChange.call(this,t),this.isTurnOn=t}catch(r){TuanApp.app.curView.showToast(r)}},on:function(){this.turn(!0)},off:function(){this.turn(!1)}},n}),define("HttpErrorHelper",[],function(){var e={500:"服务器出错，请稍后再试！",404:"连接失败，网络不给力哦！",408:"网络不给力哦，请在更好的网络环境下使用！"},t=function(t,n){return e[t]},n={getMessage:function(e){var n=e.status,r=e.statusText,i=e.timeout;if(n>=500)switch(n){case 500:r=t(500,{});break;default:r=t(500,{})}else if(n>=400)switch(n){case 408:r=t(408,{});break;case 404:r=t(404,{});break;default:r=t(404,{})}else r=t(404,{});return r}};return n}),define("NumberStep",["libs"],function(){function e(e){var t=function(){},n={max:9,min:1,initialVal:1,step:1,html:'<i class="minus <%if(initialVal <= min ){ %>num_invalid<%} %>">-</i><span id="J_curNum"><%=initialVal %></span><i class="plus <%if(initialVal >= max ){ %>num_invalid<%} %>">+</i>',wrap:null,disableClass:"num_invalid",onChange:t,onMax:t,onMin:t};this.options=$.extend(n,e),this.wrap=this.options.wrap,this.renderHtml(),this.els={curNumDom:this.wrap.find("#J_curNum"),plusDom:this.wrap.find(".plus"),minusDom:this.wrap.find(".minus"),flagDom:this.wrap.find("i")},this.bindEvents()}return e.prototype={constructor:e,bindEvents:function(){var e=this;this.wrap.on("click",".plus,.minus",function(t){var n=$(t.target),r=parseInt(e.els.curNumDom.text().trim()),i=n.text().trim()||n.attr("data-flag");if(n.hasClass(e.options.disableClass))return!1;"+"===i&&r<e.options.max?r++:"-"===i&&r>e.options.min?r--:r=e.options.min,e.els.flagDom.removeClass(e.options.disableClass),r===e.options.min&&(n.addClass(e.options.disableClass),e.options.onMin(t)),r===e.options.max&&(n.addClass(e.options.disableClass),e.options.onMax(t)),e.els.curNumDom.html(r),e.options.onChange.call(e)})},triggerChange:function(){this.options.onChange.call(this)},unbindEvents:function(){this.wrap.off("click")},_changeStatus:function(e,t){var n=t==="disable"?"addClass":"removeClass";"+"===e?this.els.plusDom[n](this.options.disableClass):"-"===e?this.els.minusDom[n](this.options.disableClass):this.els.flagDom[n](this.options.disableClass)},disable:function(e){this._changeStatus(e,"disable")},enable:function(e){this._changeStatus(e,"enable")},renderHtml:function(){this.wrap.html(_.template(this.options.html,this.options))},getCurrentNum:function(){return this.els.curNumDom.text().trim()},setCurrentNum:function(e){this.els.curNumDom.text(e)},setOptions:function(e,t){t&&(this.options[e]=t,this.options.onChange.call(this))}},e}),define("Payment",["cUtility","cWidgetGuider","cWidgetFactory","cHybridFacade","cUtilityCrypt"],function(e,t,n,r,i){function c(e,t){var n,r,s,u=e.oid||e.orderID,a=t?"/webapp/tuan/index.html#booking":"/webapp/tuan/booking",f=t?"/webapp/tuan/index.html#booking.success!{orderid}":"/webapp/tuan/bookingsuccess/{orderid}.html",l=t?"index.html":o[h()],c=t?"file:/":"http://"+location.host,p={IsNeedCardRisk:!0,payTypeList:e.payTypeList,subPayTypeList:e.subPayTypeList,isRealTimePay:e.IsRealPay||0},d=f.replace("{orderid}",u);return n=c+d,r=c+a,s=c+(e.from||a),e.oid=e.oid.toString(10),e.from=s,e.sback=n,e.eback=n,e.rback="",l+"#index?"+"bustype="+e.bustype+"&extend="+encodeURIComponent(i.Base64.encode(JSON.stringify(p)))+"&oid="+e.oid+"&token="+encodeURIComponent(i.Base64.encode(JSON.stringify(e)))}function h(){var e=u.location.host.toLowerCase(),t="uat";if(e.match(/^(m|3g|wap)\.ctrip\.com/i)||e=="10.8.2.111")t="pro";else if(e.match(/^m\.uat\.qa/i))t="uat";else if(e.match(/^(m|w\-tuan\-m)\.fat/i)||e.match(/^(localhost|127\.0)/i))t="dev";return t.toUpperCase()}var s="Payment",o={DEV:"https://secure.fws.qa.nt.ctripcorp.com/webapp/payment2/index.html",TEST:"https://secure.fws.qa.nt.ctripcorp.com/webapp/payment2/index.html",UAT:"https://secure.uat.qa.nt.ctripcorp.com/webapp/payment2/index.html",PRO:"https://secure.ctrip.com/webapp/payment2/index.html"},u=window,a=e.isInApp(),f=n.create("Guider"),l;l=a?{submit:function(e,t){var n=c(t,!0);/file\:[\\\/]*/i.test(n)&&(n="index.html#"+n.split("#")[1]),f.cross({path:"payment2",param:n})}}:{submit:function(e,t){e.jump(c(t))}},n.register({name:s,fn:l})}),define("ScrollObserver",["c"],function(){function l(e,t,n,r){return Math.abs(e-t)>=Math.abs(n-r)?e-t>0?"left":"right":n-r>0?"up":"down"}function c(){var r=this,f=t.body,c=f.scrollLeft,h=f.scrollTop;this.status==i.START?(this.status=i.BEGIN,this.direction=l(o,c,u,h),e.trigger(s.START,{direction:r.direction,y:h,x:c})):this.status=i.SCROLLING,clearTimeout(a),a=setTimeout(function(){r.status=i.START,e.trigger(s.END,{direction:r.direction,y:h,x:c}),u=f.scrollTop,o=f.scrollLeft},n)}function h(e){var n=t.body,r=n.scrollLeft,i=n.scrollTop;c()}var e=window,t=e.document,n=1e3,r="scroll",i={START:0,SCROLLING:1,END:2},s={START:"customScrollStart",END:"customScrollEnd"},o=0,u=0,a=null,f;return e=$(e),f={init:function(e){return this.status=i.END,this.__scrollHandler=$.proxy(h,this),this},enable:function(){e.on(r,this.__scrollHandler)},disable:function(){e.off(r,this.__scrollHandler)}},f}),define("MemCache",["c"],function(){var e={},t;return t={setItem:function(t,n){return e[t]=n,this},getItem:function(t){return e[t]},removeItem:function(t){delete e[t]}},t}),define("InvoiceStore",["cStore","cBase"],function(e,t){var n=n||{};n.InvoiceSearchStore=new t.Class(e,{__propertys__:function(){this.key="INVOICE_SEARCH",this.lifeTime="180S",this.defaultData={uid:0,inIds:[]},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.InvoiceListStore=new t.Class(e,{__propertys__:function(){this.key="INVOICE_LIST",this.lifeTime="180S",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.InvoiceSaveStore=new t.Class(e,{__propertys__:function(){this.key="INVOICE_SAVE",this.lifeTime="180S",this.defaultData={intle:"",inId:[],uid:0},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.InvoiceEditStore=new t.Class(e,{__propertys__:function(){this.key="INVOICE_EDIT",this.lifeTime="180S",this.defaultData={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.InvoiceSaveResultStore=new t.Class(e,{__propertys__:function(){this.key="INVOICE_RESULT",this.lifeTime="180S",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.InvoiceDeleteStore=new t.Class(e,{__propertys__:function(){this.key="INVOICE_DELETE",this.lifeTime="180S",this.defaultData={uid:0,inIds:0},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.InvoiceDeleteResultStore=new t.Class(e,{__propertys__:function(){this.key="INVOICE_DELETE_RESULT",this.lifeTime="180S",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.LiPinCard_InvoiceTitle=new t.Class(e,{__propertys__:function(){this.key="LiPinCard_InvoiceTitle",this.lifeTime="1d",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.LiPinCard_InvoiceTitle=new t.Class(e,{__propertys__:function(){this.key="LiPinCard_InvoiceTitle",this.lifeTime="1d",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.Flight_InvoiceTitle=new t.Class(e,{__propertys__:function(){this.key="Flight_InvoiceTitle",this.lifeTime="1d",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.Taocan_InvoiceTitle=new t.Class(e,{__propertys__:function(){this.key="Taocan_InvoiceTitle",this.lifeTime="1d",this.isUserData=!0},initialize:function($super,e){$super(e)}});var r=new t.Class(e,{__propertys__:function(){this.CONST_TAG="tag",this.CONST_BACKURL="backurl",this.CONST_CALLBACK="callback",this.CONST_CURVALUE="curvalue"},initialize:function($super,e){$super(e)},save:function(e,t){var n=this.get(),r=this,i=0;$.isArray(n.callback)?$.each(n.callback,function(s,o){r._callFunByStr(o,e,null,function(){i++,i===n.callback.length&&t&&t()})}):this._callFunByStr(n.callback,e,null,function(){t&&t()})},setCurrent:function(e,t,n,r,i){var s={};s[this.CONST_TAG]=e,s[this.CONST_BACKURL]=t,s[this.CONST_CALLBACK]=n,s[this.CONST_CURVALUE]=r,s[this.CONST_PATH]=i,this.set(s)},getCurrent:function(){return this.get()},getValue:function(e){var t=this.get();return this._callFunByStr(t.curvalue,null,null,e)},_callFunByStr:function(e,t,n,r){n=n||Store;var i=/^(?:(\w*)::)?(\w*):(\w*)$/i.exec(e),s,o;if(i&&i.length===4)if(i[1])require([i[1]],function(e){var n=e[i[2]],s=i[3];if(n&&n.getInstance){var o=n.getInstance()[s](t);r&&r(o)}});else{s=n[i[2]],o=i[3];if(s&&s.getInstance){var u=s.getInstance()[o](t);return r&&r(u),u}}return!1}});return n.InvoiceURLStore=new t.Class(r,{__propertys__:function(){this.key="INVOICE_URL",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),n}),define("AMapWidget",["cBase","cUICore","cUtility","cWidgetFactory","cGeoService","cWidgetGeolocation","libs"],function(e,t,n,r,i){function l(e){return e===Object(e)}var s="AMapWidget",o=function(){},u=null,a,f=$.isArray;a=new e.Class({__propertys__:function(){this.options={key:"0b895f63ca21c9e82eb158f46fe7f502",webapi:"http://webapi.amap.com/maps?v=1.2",level:13,center:u,height:0,width:0,locationButton:u,onReady:o,onZoom:o,onMovestart:o,onGeoBegin:o,onGeoComplete:o,onGeoError:o},this.__stacks=[]},initialize:function(e){var t=this,n;l(e)&&(n=$.extend(this.options,e)),this.options=n,t._updateContainerSize(n.width,n.height),t._loadScript($.proxy(t._createMap,t)),t.gps=i.GeoLocation},addMarker:function(e){var t=this,n=this.host,r=[];if(!n){this.__stacks.push(e);return}return f(e)?(e.forEach(function(e){r.push(t.addMarker(e))}),r):(r=new n.Marker(e),r.setMap(this.map),r)},removeMarker:function(e){e.setMap(null)},addEvent:function(e,t,n,r){var i,s=this;if(l(t)){for(i in t)t.hasOwnProperty(i)&&s.addEvent(e,t,t[item],r);return}s.host.event.addListener(e,t,n,r)},removeEvent:function(e,t,n,r){var i,s=this;if(l(t)){for(i in t)t.hasOwnProperty(i)&&s.addEvent(t,t[item]);return}s.host.event.removeListener(e,t,n)},setFitView:function(){this.map.setFitView()},setPosition:function(e,t,n){e.setPosition(new this.host.LngLat(t,n))},removeControl:function(e){this.map.removeControl(e)},_bindEvents:function(){var e=this.host.event;this.__zoomendHandler=$.proxy(this._zoomendHandler,this),this.__movestartHandler=$.proxy(this._movestartHandler,this),e.addListener(this.map,"zoomchange",this.__zoomendHandler),e.addListener(this.map,"movestart",this.__movestartHandler),this.__clickHandler=$.proxy(this._clickHandler,this),e.addListener(this.map,"click",this.__clickHandler)},_unbindEvents:function(){this.host.event.event.removeListener(this.map,"zoomchange",this.__zoomendHandler),this.host.event.event.removeListener(this.map,"click",this.__clickHandler)},_clickHandler:function(){this.options.onClick.call(this)},_zoomendHandler:function(e){var t=this.options;t.onZoom.call(this,e,this.map.getZoom())},_movestartHandler:function(e){var t=this.options;t.onMovestart.call(this,e)},_formatGPSInfo:function(e){return{coords:{latitude:e.lat,longitude:e.lng,accuracy:50},timestamp:+(new Date)}},_addCurrentLocationTool:function(e,t,r){var i=this,s=this.map,o=this.host;s.plugin("AMap.Geolocation",function(){geolocation=new o.Geolocation({enableHighAccuracy:!0,timeout:1e4,maximumAge:0,convert:!0,buttonDom:i.options.locationButton,showButton:!0,buttonPosition:"LB",buttonOffset:new o.Pixel(0,0),showMarker:!0,showCircle:!0,panToLocation:!1,zoomToAccuracy:!1}),n.isInApp()&&(geolocation.onButtonClick=function(){r&&r.call(geolocation,geolocation._container),i.gps.Subscribe("tuan/amap",{onComplete:function(e){geolocation.onPositionComplete(i._formatGPSInfo(e))},onError:function(e){geolocation.onPositionError(e)},onPosComplete:function(e,t){},onPosError:function(e){geolocation.onPositionError(e)}},i,!0)}),s.addControl(geolocation),o.event.addListener(geolocation,"complete",$.proxy(e,i)),o.event.addListener(geolocation,"error",$.proxy(t,i)),i.geolocation=geolocation})},_updateContainerSize:function(e,t){var n=this.options,r=n.container,i=document.body,s=r.offset();e||(e=s.width||i.clientWidth),t||(t=s.height||i.clientHeight),r.css({width:e,height:t})},_createMap:function(){var e=window.AMap,t=this.options,n=this.__stacks,r=t.center.split("|");if(!e)throw new Error("no mapapi!");this.host=e,this.map=new e.Map(t.container[0],{level:11,center:new e.LngLat(r[0],r[1])}),n.length&&this.addMarker(n),this._bindEvents(),t.locationButton&&this._addCurrentLocationTool(t.onGeoComplete,t.onGeoError,t.onGeoBegin),t.onReady.call(this)},_loadScript:function(e){if(window.AMap){e();return}var t=document.createElement("script"),n=this.options,r="__"+s+Date.now();window[r]=e,t.type="text/javascript",t.src=n.webapi+"&key="+n.key+"&callback="+r,document.body.appendChild(t)}}),r.register({name:s,fn:a})}),define("POIWidget",["cBase","cUICore","cWidgetFactory","libs"],function(e,t,n){function u(e){return e===Object(e)}var r="POIWidget",i=function(){},s=null,o;o=new e.Class({__propertys__:function(){this.options={model:s,source:3,params:{},onSuccess:i,onError:i}},initialize:function(e){var t;u(e)&&(this.options=$.extend(this.options,e)),t=this.options,this.model=t.model},query:function(e,t,n,r){var i=this,s=i.options,a=s.params;u(t)&&(t=$.extend(a,t)),a.posty=s.source,a.ctype=e||o.ALL,this.model.setParam(t),this.model.excute(function(e){(n||s.onSuccess).call(i,e)},function(e){(r||s.onError).call(i,e)},!1,i)},abort:function(){this.options.model.abort()}}),o.ALL=0,o.HOTEL=1,o.CATERING=2,o.VACATION=3,o.TICKIT=4,n.register({name:r,fn:o})}),define("LazyLoad",["libs"],function(){function e(e){var t=function(){},n={attr:"data-lazy",wrap:window,container:window,event:["scroll","resize"],time:100,threshold:180,vertical:!0,stateAttr:"data-load-state",onComplete:t,animateCls:"fade-in"};this.options=$.extend(n,e),this.container=$(this.options.container),this.wrap=$(this.options.wrap),this.eles=this.options.wrap===window?$("img"):$("img",this.wrap),this.bindEvents()}return e.prototype={constructor:e,bindEvents:function(){for(var e in this.options.event)this.container.on(this.options.event[e],function(e){this.TimerFun&&clearTimeout(this.TimerFun),this.TimerFun=setTimeout(function(){this.triggerEvent(e)}.bind(this),this.options.time)}.bind(this))},triggerEvent:function(e){var t=0,n,r,i=this.options;for(;t<this.eles.length;t++){n=$(this.eles[t]),r=n.attr(i.attr);if(!r||n[0].src.trim()===r.trim())continue;this.isReady(n)&&this._loadImage(r,function(e){return function(){e[0].src=e.attr(i.attr),e.addClass(i.animateCls),e.attr(i.stateAttr,"true")}}(n))}i.onComplete.call(this,e)},_loadImage:function(e,t){var n=new Image;n.src=e;if(n.complete){t.call(n);return}n.onload=function(){n.onload=null,t.call(n)}},isReady:function(e){var t=this.options.vertical?"scrollTop":"scrollLeft",n=this.options.vertical?"top":"left",r=e.offset()[n],i=this.options.vertical?this.container.height():this.container.width(),s=this.container[t]();return r>=s&&r<=i+s+this.options.threshold},updateDom:function(){this.eles=this.options.wrap===window?$("img").not("["+this.options.stateAttr+' = "true"]'):$("img",this.wrap).not("["+this.options.stateAttr+'="true"]'),this.container.trigger(this.options.event[0])},unbindEvents:function(){for(var e in this.options.event)this.container.off(this.options.event[e])}},e}),"use strict",define("FilterXss",[],function(){function l(e,t,n){if(t==="href"||t==="src"){o.lastIndex=0;if(o.test(n))return"#";u.lastIndex=0;if(u.test(n))return"#"}else if(t==="style"){a.lastIndex=0;if(a.test(n))return"#";f.lastIndex=0;if(f.test(n))return""}}function c(e,t,n){return h(t)}function h(e){return e.replace(t,"&lt;").replace(n,"&gt;")}function p(e,t){return String.fromCharCode(parseInt(t))}function d(t){this.options=t=t||{},this.whiteList=$.extend(!0,e,t.whiteList||{}),this.onTagAttr=$.extend(!0,l,t.onTagAttr||{}),this.onIgnoreTag=$.extend(!0,c,t.onIgnoreTag||{})}var e={h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],hr:[],span:[],strong:[],b:[],i:[],br:[],p:[],pre:[],code:[],a:["target","href","title"],img:["src","alt","title"],div:[],table:["width","border"],tr:[],td:["width","colspan"],th:["width","colspan"],tbody:[],ul:[],li:[],ol:[],dl:[],dt:[],em:[],cite:[],section:[],header:[],footer:[],blockquote:[],audio:["autoplay","controls","loop","preload","src"],video:["autoplay","controls","loop","preload","src","height","width"]},t=/</g,n=/>/g,r=/"/g,i=/[^a-zA-Z0-9_:\.\-]/img,s=/&#([a-zA-Z0-9]*);?/img,o=/\/\*|\*\//mg,u=/^[\s"'`]*((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/ig,a=/\/\*|\*\//mg,f=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/ig;return d.prototype={constructor:d,filterAttributes:function(e,t){e=e.toLowerCase();var n=this,o=this.whiteList[e],u=0,a="",f=!1,l=!1,c=function(t,u){t=t.trim();if(!l&&t==="/"){l=!0;return}t=t.replace(i,"").toLowerCase();if(t.length<1)return;if(o.indexOf(t)!==-1){if(u){u=u.trim().replace(r,"&quote;"),u=u.replace(s,p);var f="";for(var c=0,h=u.length;c<h;c++)f+=u.charCodeAt(c)<32?" ":u[c];u=f.trim();var d=n.onTagAttr(e,t,u);typeof d!="undefined"&&(u=d)}a+=t+(u?'="'+u+'"':"")+" "}};for(var h=0,d=t.length;h<d;h++){var v=t[h];if(f===!1&&v==="="){f=t.slice(u,h),u=h+1;continue}if(f!==!1&&h===u&&(v==='"'||v==="'")){var m=t.indexOf(v,h+1);if(m===-1)break;var g=t.slice(u+1,m).trim();c(f,g),f=!1,h=m,u=h+1;continue}if(v===" "){var g=t.slice(u,h).trim();f===!1?c(g):c(f,g),f=!1,u=h+1;continue}}return u<t.length&&(f===!1?c(t.slice(u)):c(f,t.slice(u))),l&&(a+="/"),a.trim()},addNewTag:function(e,t,n){var r="",i=e.slice(0,2)==="</"?2:1,s=e.indexOf(" ");if(s===-1)var o=e.slice(i,e.length-1).trim();else var o=e.slice(i,s+1).trim();o=o.toLowerCase();if(o in this.whiteList)if(s===-1)r+=e.slice(0,i)+o+">";else{var u=this.filterAttributes(o,e.slice(s+1,e.length-1).trim());r+=e.slice(0,i)+o+(u.length>0?" "+u:"")+">"}else{var a={isClosing:i===2,position:n,originalPosition:t-e.length+1},f=this.onIgnoreTag(o,e,a);typeof f=="undefined"&&(f=h(e)),r+=f}return r},process:function(e){var t="",n=0,r=!1,i=!1,s=0;if($.type(e)!=="string")return"";for(var s=0,o=e.length;s<o;s++){var u=e[s];if(r===!1){if(u==="<"){r=s;continue}}else if(i===!1){if(u==="<"){t+=h(e.slice(n,s)),r=s,n=s;continue}if(u===">"){t+=h(e.slice(n,r)),t+=this.addNewTag(e.slice(r,s+1),s,t.length),n=s+1,r=!1;continue}if(u==='"'||u==="'"){i=u;continue}}else if(u===i){i=!1;continue}}return n<e.length&&(t+=h(e.substr(n))),t}},d.Instance=new d,{filterXSS:function(e,t){return t&&$.isPlainObject(t)&&(d.Instance=new d(t)),d.Instance.process(e)},tagFilter:function(e,t){typeof t!="function"&&(t=function(){});var n=[],r=!1;return{onIgnoreTag:function(i,s,o){if(e.indexOf(i)!==-1){var u="[removed]";if(r!==!1&&o.isClosing){var a=o.position+u.length;n.push([r,a]),r=!1}else r=o.position;return u}return t(i,s,o)},filter:function(e){var t="",r=0;return n.forEach(function(n){t+=e.slice(r,n[0]),r=n[1]}),t+=e.slice(r),t}}}}});