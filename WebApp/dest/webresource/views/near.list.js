define(["TuanApp","TuanBaseView","cCommonPageFactory","LazyLoad","TuanStore","TuanModel","text!NearListTpl"],function(e,t,n,r,i,s,o){var u=i.TuanDetailsStore.getInstance(),a=s.TuanNearListModel.getInstance(),f="周边团购",l=n.create("TuanBaseView"),c=l.extend({pageid:"214008",hpageid:"215008",setHeader:function(e){var t=this;this.header.set({title:e||f,back:!0,view:this,events:{returnHandler:function(){t.back()}}}),this.header.show()},events:{"click li[data-id]":"detailHandler"},onCreate:function(){this.itemRenderFn=_.template(o)},onLoad:function(){var e=Lizard.P("pid"),t=Lizard.P("title");e||this.back(),this.setHeader(t),this.getNearList(e)},onHide:function(){this.hideWarning404(),this.LazyLoad&&this.LazyLoad.unbindEvents()},onShow:function(){this.LazyLoad=new r({wrap:this.$el,animate:"opacity-fade-in"})},getNearList:function(t){var n={id:t,environment:e.environment},r=Lizard.P("category");r&&(n.category=r),a.setParam(n),a.excute(function(e){e.showTags=!1,this.renderList(e)},function(e){var t=this;t.showWarning404(function(){t.onLoad()})},!1,this)},renderList:function(e){var t=this.itemRenderFn(e);this.$el.html($.trim(t)),this.LazyLoad&&this.LazyLoad.updateDom()},detailHandler:function(e){var t=$(e.currentTarget).attr("data-id"),n=Lizard.P("cityid");this.forwardJump("detail","/webapp/tuan/detail/"+t+".html"+(n?"?cityid="+n:""))}});return c});