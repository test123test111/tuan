define(["cUtility","cWidgetGuider","cWidgetFactory","cHybridFacade","cUtilityCrypt"],function(t,e,i,a,n){function o(t,e,i){var a,o,c,r=t.oid||t.orderID,m=e?"/webapp/tuan/index.html#booking":"/webapp/tuan/booking",d=e?"/webapp/tuan/index.html#booking.success!{orderid}":"/webapp/tuan/bookingsuccess/{orderid}.html",u=e?"index.html":s[p()],y=e?"file:/":"http://"+location.host,b={IsNeedCardRisk:!0,payTypeList:t.payTypeList,subPayTypeList:t.subPayTypeList},h=d.replace("{orderid}",r);return i&&(b.isRealTimePay=i.IsRealPay||0),a=y+h,o=y+m,c=y+(t.from||m),t.oid=t.oid.toString(10),t.from=c,t.sback=a,t.eback=a,t.rback="",u+"#index?bustype="+t.bustype+"&extend="+encodeURIComponent(n.Base64.encode(JSON.stringify(b)))+"&oid="+t.oid+"&token="+encodeURIComponent(n.Base64.encode(JSON.stringify(t)))}function p(){var t=m.location.host.toLowerCase(),e="uat";return t.match(/^(m|3g|wap)\.ctrip\.com/i)||"10.8.2.111"==t?e="pro":t.match(/^m\.uat\.qa/i)?e="uat":(t.match(/^(m|w\-tuan\-m)\.fat/i)||t.match(/^(localhost|127\.0)/i))&&(e="dev"),e.toUpperCase()}var c,r="Payment",s={DEV:"https://secure.fat18.qa.nt.ctripcorp.com/webapp/payment2/index.html",TEST:"https://secure.fat18.qa.nt.ctripcorp.com/webapp/payment2/index.html",UAT:"https://secure.uat.qa.nt.ctripcorp.com/webapp/payment2/index.html",PRO:"https://secure.ctrip.com/webapp/payment2/index.html"},m=window,d=t.isInApp(),u=i.create("Guider");c=d?{submit:function(t,e,i){var a=o(e,!0,i);/file\:[\\\/]*/i.test(a)&&(a="index.html#"+a.split("#")[1]),u.cross({path:"payment2",param:a})}}:{submit:function(t,e,i){t.jump(o(e,!1,i))}},i.register({name:r,fn:c})});