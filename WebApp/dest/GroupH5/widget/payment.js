define(["cUtility","cWidgetGuider","cWidgetFactory","cHybridFacade","cUtilityCrypt"],function(e,t,n,r,i){function c(e,t,n){var r,s,u,a=e.oid||e.orderID,f=t?"/webapp/tuan/index.html#booking":"/webapp/tuan/booking",l=t?"/webapp/tuan/index.html#booking.success!{orderid}":"/webapp/tuan/bookingsuccess/{orderid}.html",c=t?"index.html":o[h()],p=t?"file:/":"http://"+location.host,d={IsNeedCardRisk:!0,payTypeList:e.payTypeList,subPayTypeList:e.subPayTypeList},v=l.replace("{orderid}",a);return n&&(d.isRealTimePay=n.IsRealPay||0),r=p+v,s=p+f,u=p+(e.from||f),e.oid=e.oid.toString(10),e.from=u,e.sback=r,e.eback=r,e.rback="",c+"#index?"+"bustype="+e.bustype+"&extend="+encodeURIComponent(i.Base64.encode(JSON.stringify(d)))+"&oid="+e.oid+"&token="+encodeURIComponent(i.Base64.encode(JSON.stringify(e)))}function h(){var e=u.location.host.toLowerCase(),t="uat";if(e.match(/^(m|3g|wap)\.ctrip\.com/i)||e=="10.8.2.111")t="pro";else if(e.match(/^m\.uat\.qa/i))t="uat";else if(e.match(/^(m|w\-tuan\-m)\.fat/i)||e.match(/^(localhost|127\.0)/i))t="dev";return t.toUpperCase()}var s="Payment",o={DEV:"https://secure.fws.qa.nt.ctripcorp.com/webapp/payment2/index.html",TEST:"https://secure.fws.qa.nt.ctripcorp.com/webapp/payment2/index.html",UAT:"https://secure.uat.qa.nt.ctripcorp.com/webapp/payment2/index.html",PRO:"https://secure.ctrip.com/webapp/payment2/index.html"},u=window,a=e.isInApp(),f=n.create("Guider"),l;l=a?{submit:function(e,t,n){var r=c(t,!0,n);/file\:[\\\/]*/i.test(r)&&(r="index.html#"+r.split("#")[1]),f.cross({path:"payment2",param:r})}}:{submit:function(e,t,n){e.jump(c(t,!1,n))}},n.register({name:s,fn:l})});