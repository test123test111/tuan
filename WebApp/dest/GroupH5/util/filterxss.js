"use strict";define([],function(){function e(e,t,i){if("href"===t||"src"===t){if(u.lastIndex=0,u.test(i))return"#";if(h.lastIndex=0,h.test(i))return"#"}else if("style"===t){if(g.lastIndex=0,g.test(i))return"#";if(d.lastIndex=0,d.test(i))return""}}function t(e,t){return i(t)}function i(e){return e.replace(o,"&lt;").replace(l,"&gt;")}function n(e,t){return String.fromCharCode(parseInt(t))}function r(i){this.options=i=i||{},this.whiteList=$.extend(!0,s,i.whiteList||{}),this.onTagAttr=$.extend(!0,e,i.onTagAttr||{}),this.onIgnoreTag=$.extend(!0,t,i.onIgnoreTag||{})}var s={h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],hr:[],span:[],strong:[],b:[],i:[],br:[],p:[],pre:[],code:[],a:["target","href","title"],img:["src","alt","title"],div:[],table:["width","border"],tr:[],td:["width","colspan"],th:["width","colspan"],tbody:[],ul:[],li:[],ol:[],dl:[],dt:[],em:[],cite:[],section:[],header:[],footer:[],blockquote:[],audio:["autoplay","controls","loop","preload","src"],video:["autoplay","controls","loop","preload","src","height","width"]},o=/</g,l=/>/g,a=/"/g,c=/[^a-zA-Z0-9_:\.\-]/gim,f=/&#([a-zA-Z0-9]*);?/gim,u=/\/\*|\*\//gm,h=/^[\s"'`]*((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,g=/\/\*|\*\//gm,d=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi;return r.prototype={constructor:r,filterAttributes:function(e,t){e=e.toLowerCase();for(var i=this,r=this.whiteList[e],s=0,o="",l=!1,u=!1,h=function(t,s){if(t=t.trim(),!u&&"/"===t)return void(u=!0);if(t=t.replace(c,"").toLowerCase(),!(t.length<1)&&-1!==r.indexOf(t)){if(s){s=s.trim().replace(a,"&quote;"),s=s.replace(f,n);for(var l="",h=0,g=s.length;g>h;h++)l+=s.charCodeAt(h)<32?" ":s[h];s=l.trim();var d=i.onTagAttr(e,t,s);"undefined"!=typeof d&&(s=d)}o+=t+(s?'="'+s+'"':"")+" "}},g=0,d=t.length;d>g;g++){var p=t[g];if(l!==!1||"="!==p)if(l===!1||g!==s||'"'!==p&&"'"!==p)if(" "!==p);else{var v=t.slice(s,g).trim();l===!1?h(v):h(l,v),l=!1,s=g+1}else{var m=t.indexOf(p,g+1);if(-1===m)break;var v=t.slice(s+1,m).trim();h(l,v),l=!1,g=m,s=g+1}else l=t.slice(s,g),s=g+1}return s<t.length&&(l===!1?h(t.slice(s)):h(l,t.slice(s))),u&&(o+="/"),o.trim()},addNewTag:function(e,t,n){var r="",s="</"===e.slice(0,2)?2:1,o=e.indexOf(" ");if(-1===o)var l=e.slice(s,e.length-1).trim();else var l=e.slice(s,o+1).trim();if(l=l.toLowerCase(),l in this.whiteList)if(-1===o)r+=e.slice(0,s)+l+">";else{var a=this.filterAttributes(l,e.slice(o+1,e.length-1).trim());r+=e.slice(0,s)+l+(a.length>0?" "+a:"")+">"}else{var c={isClosing:2===s,position:n,originalPosition:t-e.length+1},f=this.onIgnoreTag(l,e,c);"undefined"==typeof f&&(f=i(e)),r+=f}return r},process:function(e){var t="",n=0,r=!1,s=!1,o=0;if("string"!==$.type(e))return"";for(var o=0,l=e.length;l>o;o++){var a=e[o];if(r===!1){if("<"===a){r=o;continue}}else if(s===!1){if("<"===a){t+=i(e.slice(n,o)),r=o,n=o;continue}if(">"===a){t+=i(e.slice(n,r)),t+=this.addNewTag(e.slice(r,o+1),o,t.length),n=o+1,r=!1;continue}if('"'===a||"'"===a){s=a;continue}}else if(a===s){s=!1;continue}}return n<e.length&&(t+=i(e.substr(n))),t}},r.Instance=new r,{filterXSS:function(e,t){return t&&$.isPlainObject(t)&&(r.Instance=new r(t)),r.Instance.process(e)},tagFilter:function(e,t){"function"!=typeof t&&(t=function(){});var i=[],n=!1;return{onIgnoreTag:function(r,s,o){if(-1!==e.indexOf(r)){var l="[removed]";if(n!==!1&&o.isClosing){var a=o.position+l.length;i.push([n,a]),n=!1}else n=o.position;return l}return t(r,s,o)},filter:function(e){var t="",n=0;return i.forEach(function(i){t+=e.slice(n,i[0]),n=i[1]}),t+=e.slice(n)}}}}});