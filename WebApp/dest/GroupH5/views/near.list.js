define(["TuanApp","TuanBaseView","cCommonPageFactory","LazyLoad","TuanStore","TuanModel","text!NearListTpl"],function(t,e,a,i,n,r,d){var o=(n.TuanDetailsStore.getInstance(),r.TuanNearListModel.getInstance()),s="周边团购",h=a.create("TuanBaseView"),c=h.extend({pageid:"214008",hpageid:"215008",setHeader:function(t){var e=this;this.header.set({title:t||s,back:!0,view:this,events:{returnHandler:function(){e.back()}}}),this.header.show()},events:{"click li[data-id]":"detailHandler"},onCreate:function(){this.itemRenderFn=_.template(d)},onLoad:function(){var t=Lizard.P("pid"),e=Lizard.P("title");t||this.back(),this.setHeader(e),this.getNearList(t)},onHide:function(){this.hideWarning404(),this.LazyLoad&&this.LazyLoad.unbindEvents()},onShow:function(){this.LazyLoad=new i({wrap:this.$el,animate:"opacity-fade-in"})},getNearList:function(e){var a={id:e,environment:t.environment},i=Lizard.P("category");i&&(a.category=i),o.setParam(a),o.excute(function(t){t.showTags=!1,this.renderList(t)},function(){var t=this;t.showWarning404(function(){t.onLoad()})},!1,this)},renderList:function(t){var e=this.itemRenderFn(t);this.$el.html($.trim(e)),this.LazyLoad&&this.LazyLoad.updateDom()},detailHandler:function(t){var e=$(t.currentTarget).attr("data-id"),a=Lizard.P("cityid");this.forwardJump("detail","/webapp/tuan/detail/"+e+".html"+(a?"?cityid="+a:""))}});return c});