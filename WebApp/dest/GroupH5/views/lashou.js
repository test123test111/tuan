define(["TuanApp","libs","c","TuanBaseView","cCommonPageFactory","TuanStore","TuanModel","text!LashouTpl"],function(t,e,n,i,a,r,s,o){var c="btm_tuan_btn_dis",u=r.TuanDetailsStore.getInstance(),l=s.TuanDetailModel.getInstance(),d=a.create("TuanBaseView"),f=d.extend({events:{"click #J_submit":"submit"},getGroupContent:function(){var t=this,e=u.getAttr("contents");if(e){var n=_.find(e,function(t){return 5==t.type});n?t.render(u.get()):(t.showMessage("无图文详情!"),this.setHeader())}else t.showLoading(),l.setParam({id:Lizard.P("pid")}),l.excute(function(n){if(e=n&&n.contents,t.hideLoading(),e){var i=_.find(e,function(t){return 5==t.type});i?t.render(n):t.showMessage("无图文详情!")}},function(){t.hideLoading(),t.showToast("获取图文详情失败!")})},render:function(t){var e=t.price,n=t.activities,i=_.find(t.contents,function(t){return 5==t.type});this.setHeader(i.title),this.$el.html($.trim(_.template(o,{content:i,price:e,activities:n})));var a=this.$el.find("#J_submit");(99==t.labelVal||100==t.labelVal)&&a.attr("class",c).text(t.labelText).removeAttr("id"),t.channelInfo&&t.channelInfo.isCorrectChannel||a.attr("class",c)},onCreate:function(){},onLoad:function(){this.parseDetailUrl(),this.getGroupContent()},parseDetailUrl:function(){var t=Lizard.P("pid"),e=Lizard.P("url");this.productId=t,this.externalReferURL=e},setHeader:function(t){var e=this;this.header.set({title:t||"团购包含",back:!0,view:this,events:{returnHandler:function(){e.backAction()}}})},onShow:function(){},onHide:function(){},backAction:function(){this.back()},submit:function(){this.$el.find("#J_submit").hasClass(c)||this.forwardJump("booking","/webapp/tuan/booking"+(this.externalReferURL?"?from="+this.externalReferURL:""))}});return f});