define(["TuanApp","libs","c","TuanBaseView","cCommonPageFactory","TuanStore","TuanModel","text!LashouTpl"],function(e,t,n,r,i,s,o,u){var a="btm_tuan_btn_dis",f=s.TuanDetailsStore.getInstance(),l=o.TuanDetailModel.getInstance(),c=i.create("TuanBaseView"),h=c.extend({events:{"click #J_submit":"submit"},getGroupContent:function(){var e=this,t=f.getAttr("contents");if(t){var n=_.find(t,function(e){return e.type==5});n?e.render(f.get()):(e.showMessage("无图文详情!"),this.setHeader())}else e.showLoading(),l.setParam({id:Lizard.P("pid")}),l.excute(function(n){t=n&&n.contents,e.hideLoading();if(t){var r=_.find(t,function(e){return e.type==5});r?e.render(n):e.showMessage("无图文详情!")}},function(t){e.hideLoading(),e.showToast("获取图文详情失败!")})},render:function(e){var t=e.price,n=e.activities,r=_.find(e.contents,function(e){return e.type==5});this.setHeader(r.title),this.$el.html($.trim(_.template(u,{content:r,price:t,activities:n})));var i=this.$el.find("#J_submit");(e.labelVal==99||e.labelVal==100)&&i.attr("class",a).text(e.labelText).removeAttr("id"),(!e.channelInfo||!e.channelInfo.isCorrectChannel)&&i.attr("class",a)},onCreate:function(){},onLoad:function(){this.parseDetailUrl(),this.getGroupContent()},parseDetailUrl:function(){var e=Lizard.P("pid"),t=Lizard.P("url");this.productId=e,this.externalReferURL=t},setHeader:function(e){var t=this;this.header.set({title:e||"团购包含",back:!0,view:this,events:{returnHandler:function(){t.backAction()}}})},onShow:function(){},onHide:function(){},backAction:function(){this.back()},submit:function(){this.$el.find("#J_submit").hasClass(a)||this.forwardJump("booking","/webapp/tuan/booking"+(this.externalReferURL?"?from="+this.externalReferURL:""))}});return h});