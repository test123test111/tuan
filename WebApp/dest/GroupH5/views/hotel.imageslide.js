define(["TuanApp","TuanBaseView","TuanModel","TuanStore","text!HotelImageSlideTpl","cWidgetFactory","cCommonPageFactory","SmoothSlide"],function(t,e,i,n,a,o,c){var s,r,d=n.TuanDetailsStore.getInstance(),h=n.TuanImagesListStore.getInstance(),l=i.TuanImagesListModel.getInstance(),u=o.create("SmoothSlide"),g=c.create("TuanBaseView");return r=g.extend({pageid:"260003",hpageid:"261003",events:{"click article":"clickHandler"},onCreate:function(){},onLoad:function(){var t=this;this.pid=Lizard.P("pid");var e=d.getAttr("images"),i=h.getAttr("images");e&&+d.getAttr("id")===+this.pid?this.createSlide(e):i&&+h.getAttr("id")===+this.pid?this.createSlide(i):(t.showLoading(),l.setParam({id:this.pid}),l.excute(function(e){e=e&&e.images,t.hideLoading(),e&&e.length&&t.createSlide(e)},function(){t.hideLoading(),t.showToast("图片数据获取失败！")}))},onShow:function(){this.header&&this.header.hide()},onHide:function(){!t.isInApp&&this.header&&this.header.rootBox&&this.header.rootBox.show()},backAction:function(){this.back({did:this.pid})},backHome:function(){t.tHome()},createSlide:function(t){var e,i=this,n=Lizard.P("index"),o=i.$el.find("#J_sliderWrap"),c=[],r=t&&t.length,d=function(t,i,n){e.html(n+"<br/>"+(t+1)+"/"+i)};if(n=n>0?n-1:0,i.storeIndex(n),r)for(var h=0;r>h;h++)c.push({title:t[h].title,src:t[h].large,href:"#",desc:t[h].desc});c.length&&(o.parent().parent().css("height","100%"),s=new u({container:o,source:c,itemCls:".pics_show_box_items",autoplay:0,prefetch:3,currentIndex:n,width:$("body").offset().width,tpl:a,onSwitchEnd:function(){},onSwitch:function(t,e){i.storeIndex(t),d(t,this.count(),e.title)},onInit:function(t){e=$(this.container).find("#J_picDesc"),d(t,this.count(),this.source[t].title)}}),this.slider=s)},clickHandler:function(t){t.target&&"article"===t.target.tagName.toLocaleLowerCase()&&this.backAction()},storeIndex:function(t){d.setAttr("imageIndex",t)}})});