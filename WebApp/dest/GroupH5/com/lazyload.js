define(["libs"],function(){function t(t){var i=function(){},n={attr:"data-lazy",wrap:window,container:window,event:["scroll","resize"],time:100,threshold:180,vertical:!0,stateAttr:"data-load-state",onComplete:i,animateCls:"fade-in"};this.options=$.extend(n,t),this.container=$(this.options.container),this.wrap=$(this.options.wrap),this.eles=this.options.wrap===window?$("img"):$("img",this.wrap),this.bindEvents()}return t.prototype={constructor:t,bindEvents:function(){for(var t in this.options.event)this.container.on(this.options.event[t],function(t){this.TimerFun&&clearTimeout(this.TimerFun),this.TimerFun=setTimeout(function(){this.triggerEvent(t)}.bind(this),this.options.time)}.bind(this))},triggerEvent:function(t){for(var i,n,o=0,e=this.options;o<this.eles.length;o++)i=$(this.eles[o]),n=i.attr(e.attr),n&&i[0].src.trim()!==n.trim()&&this.isReady(i)&&this._loadImage(n,function(t){return function(){t[0].src=t.attr(e.attr),t.addClass(e.animateCls),t.attr(e.stateAttr,"true")}}(i));e.onComplete.call(this,t)},_loadImage:function(t,i){var n=new Image;return n.src=t,n.complete?void i.call(n):void(n.onload=function(){n.onload=null,i.call(n)})},isReady:function(t){var i=this.options.vertical?"scrollTop":"scrollLeft",n=this.options.vertical?"top":"left",o=t.offset()[n],e=this.options.vertical?this.container.height():this.container.width(),s=this.container[i]();return o>=s&&o<=e+s+this.options.threshold},updateDom:function(){this.eles=this.options.wrap===window?$("img").not("["+this.options.stateAttr+' = "true"]'):$("img",this.wrap).not("["+this.options.stateAttr+'="true"]'),this.container.trigger(this.options.event[0])},unbindEvents:function(){for(var t in this.options.event)this.container.off(this.options.event[t])}},t});