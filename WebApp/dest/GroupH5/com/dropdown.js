define(["libs","cUIMask"],function(t,e){function i(t){var i={triggerEvent:"click",trigger:null,panel:null,label:null,itemCls:"li[data-type]",hasEffect:!0,hasMask:!0,selectedIndex:0,activeTriggerCls:"",selectedItemCls:"typecrt",multiple:!1,onShow:s,onHide:s,onSelect:s},o=this;this.options=n(i,t),this.trigger=this.options.trigger,this.panel=this.options.panel,this.label=this.options.label,this.disabled=!1,this.opened=!1,this.items=this.panel.find(this.options.itemCls),this.reset(!0),this.options.hasMask&&(this.mask=new e({onCreate:function(){var t=this;this.root.on("click",function(){o.hide(),t.hide()})}}),this.panel.css("z-index",9999)),this._bindEvents()}var s=function(){},n=$.extend;return i.prototype={constructor:i,_bindEvents:function(){var t=this,e=this.options,i=this.trigger;this._showHandler=$.proxy(function(){this.opened?(this.hide(),e.onHide.call(t)):(this.show(),e.onShow.call(t))},this),this._selectHandler=$.proxy(function(t){t.preventDefault(),t.stopPropagation(),this.select(t.target),this.hide()},this),this._hideHandler=$.proxy(function(){var t=this;setTimeout(function(){t.hide()},200)},this),i.on(e.triggerEvent,this._showHandler),i.on("blur",this._hideHandler),this.panel.on("click",e.itemCls,this._selectHandler)},_unbindEvents:function(){var t=this.options;this.trigger.off(t.triggerEvent,this._showHandler),this.panel.off("click",this._selectHandler)},disable:function(){this._unbindEvents(),this.disabled=!0},enable:function(){this._bindEvents(),this.disabled=!1},show:function(){var t=this.panel;t.show(),this.options.hasEffect&&(t.css({"-webkit-transform":"translate(0, 30px) translateZ(0)",opacity:0}),t.animate({"-webkit-transform":"translate(0, -8px) translateZ(0)",opacity:1})),this.mask&&this.mask.show(),this.trigger.addClass(this.options.activeTriggerCls),this.opened=!0},hide:function(){var t=this;t.panel.hide(),t.mask&&t.mask.hide(),t.trigger.removeClass(t.options.activeTriggerCls),t.opened=!1},getItemByAttr:function(t,e){return this.panel.find("[data-"+t+'="'+e+'"]')},getItemByIndex:function(t){return this.items[t]},select:function(t,e){var i=this.options,s=this._selected,n=i.selectedItemCls;s&&s.removeClass(n),"LI"!=t.tagName&&(t=t.parentNode),this.selectedIndex=this.items.indexOf(t),t=$(t),this.label.html(t.attr("data-name")||t.text()),t.addClass(n),!e&&this.options.onSelect.call(this,t),this._selected=t},reset:function(t,e){this.select(this.items["number"==typeof e?e:this.options.selectedIndex],t)}},i});